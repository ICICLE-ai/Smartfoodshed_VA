{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/yameitu/Desktop/ICIRCLE/Smartfoodshed_VA_VC1/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.array.splice.js\";\n\n/* global d3, document */\n\n/* jshint latedef:nofunc */\nimport * as d3 from 'd3';\n\nfunction Neo4jD3(_selector, _options) {\n  var container,\n      graph,\n      info,\n      node,\n      nodes,\n      relationship,\n      relationshipOutline,\n      relationshipOverlay,\n      relationshipText,\n      relationships,\n      selector,\n      simulation,\n      svg,\n      svgNodes,\n      svgRelationships,\n      svgScale,\n      svgTranslate,\n      classes2colors = {},\n      justLoaded = false,\n      numClasses = 0,\n      options = {\n    arrowSize: 4,\n    colors: colors(),\n    highlight: undefined,\n    iconMap: fontAwesomeIcons(),\n    icons: undefined,\n    imageMap: {},\n    images: undefined,\n    infoPanel: true,\n    minCollision: undefined,\n    neo4jData: undefined,\n    neo4jDataUrl: undefined,\n    nodeOutlineFillColor: undefined,\n    nodeRadius: 25,\n    relationshipColor: '#a5abb6',\n    zoomFit: false\n  },\n      VERSION = '0.0.1';\n\n  function appendGraph(container) {\n    svg = container.append('svg').attr('width', '100%').attr('height', '100%').attr('class', 'neo4jd3-graph').on('dblclick.zoom', null).append('g').attr('width', '100%').attr('height', '100%');\n    svgRelationships = svg.append('g').attr('class', 'relationships');\n    svgNodes = svg.append('g').attr('class', 'nodes');\n  }\n\n  function appendImageToNode(node) {\n    return node.append('image').attr('height', function (d) {\n      return icon(d) ? '24px' : '30px';\n    }).attr('x', function (d) {\n      return icon(d) ? '5px' : '-15px';\n    }).attr('xlink:href', function (d) {\n      return image(d);\n    }).attr('y', function (d) {\n      return icon(d) ? '5px' : '-16px';\n    }).attr('width', function (d) {\n      return icon(d) ? '24px' : '30px';\n    });\n  }\n\n  function appendInfoPanel(container) {\n    return container.append('div').attr('class', 'neo4jd3-info');\n  }\n\n  function appendInfoElement(cls, isNode, property, value) {\n    var elem = info.append('a');\n    elem.attr('href', '#').attr('class', cls).html('<strong>' + property + '</strong>' + (value ? ': ' + value : ''));\n\n    if (!value) {\n      elem.style('background-color', function (d) {\n        return options.nodeOutlineFillColor ? options.nodeOutlineFillColor : isNode ? class2color(property) : defaultColor();\n      }).style('border-color', function (d) {\n        return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : isNode ? class2darkenColor(property) : defaultDarkenColor();\n      }).style('color', function (d) {\n        return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : '#fff';\n      });\n    }\n  }\n\n  function appendInfoElementClass(cls, node) {\n    appendInfoElement(cls, true, node);\n  }\n\n  function appendInfoElementProperty(cls, property, value) {\n    appendInfoElement(cls, false, property, value);\n  }\n\n  function appendInfoElementRelationship(cls, relationship) {\n    appendInfoElement(cls, false, relationship);\n  }\n\n  function appendNode() {\n    // exist removed nodes\n    node.exit().remove();\n    return node.enter().append('g').attr('class', function (d) {\n      var highlight,\n          i,\n          classes = 'node',\n          label = d.labels[0];\n\n      if (icon(d)) {\n        classes += ' node-icon';\n      }\n\n      if (image(d)) {\n        classes += ' node-image';\n      }\n\n      if (options.highlight) {\n        for (i = 0; i < options.highlight.length; i++) {\n          highlight = options.highlight[i];\n\n          if (d.labels[0] === highlight.class && d.properties[highlight.property] === highlight.value) {\n            classes += ' node-highlighted';\n            break;\n          }\n        }\n      }\n\n      return classes;\n    }).attr('id', function (d) {\n      return \"node-\".concat(d.id);\n    }).on('click', function (d, i) {\n      d.fx = d.fy = null;\n\n      if (typeof options.onNodeClick === 'function') {\n        options.onNodeClick(d, i);\n      }\n    }).on('dblclick', function (d) {\n      stickNode(d);\n\n      if (typeof options.onNodeDoubleClick === 'function') {\n        options.onNodeDoubleClick(d);\n      }\n    }).on('mouseenter', function (d) {\n      if (info) {\n        updateInfo(d);\n      }\n\n      if (typeof options.onNodeMouseEnter === 'function') {\n        options.onNodeMouseEnter(d);\n      }\n    }).on('mouseleave', function (d) {\n      if (info) {\n        clearInfo(d);\n      }\n\n      if (typeof options.onNodeMouseLeave === 'function') {\n        options.onNodeMouseLeave(d);\n      }\n    }).call(d3.drag().on('start', dragStarted).on('drag', dragged).on('end', dragEnded));\n  }\n\n  function appendNodeToGraph() {\n    var n = appendNode();\n    appendRingToNode(n);\n    appendOutlineToNode(n);\n    appendLabeltoNode(n);\n\n    if (options.icons) {\n      appendTextToNode(n);\n    }\n\n    if (options.images) {\n      appendImageToNode(n);\n    }\n\n    return n;\n  }\n\n  function appendLabeltoNode(node) {\n    node.each(function (d) {\n      var mapping = d['properties']['mapping'];\n      var text_nodes = textDisplay(d['properties'][mapping]);\n      var selection = d3.select(this);\n\n      if (text_nodes.length == 1) {\n        selection.append('text').attr('x', '0').attr('y', '0').style('font-size', '10px').style('text-anchor', 'middle').style('fill', 'white').style('pointer-events', 'none').style('font-weight', 'bold').text(text_nodes[0]);\n      } else if (text_nodes.length == 2) {\n        selection.append('text').attr('x', '0').attr('y', '-4').style('font-size', '10px').style('text-anchor', 'middle').style('pointer-events', 'none').style('fill', 'white').style('font-weight', 'bold').text(text_nodes[0]);\n        selection.append('text').attr('x', '0').attr('y', '12').style('font-size', '10px').style('text-anchor', 'middle').style('pointer-events', 'none').style('fill', 'white').style('font-weight', 'bold').text(text_nodes[1]);\n      } else {\n        selection.append('text').attr('x', '0').attr('y', '-12').style('font-size', '10px').style('pointer-events', 'none').style('text-anchor', 'middle').style('fill', 'white').style('font-weight', 'bold').text(text_nodes[0]);\n        selection.append('text').attr('x', '0').attr('y', '0').style('font-size', '10px').style('text-anchor', 'middle').style('pointer-events', 'none').style('fill', 'white').style('font-weight', 'bold').text(text_nodes[1]);\n        selection.append('text').attr('x', '0').attr('y', '12').style('font-size', '10px').style('pointer-events', 'none').style('text-anchor', 'middle').style('fill', 'white').style('font-weight', 'bold').text(text_nodes[2]);\n      }\n    }); // const text_nodes = textDisplay()\n  }\n\n  function textDisplay(text) {\n    var threshold = 9;\n    var res = [];\n\n    if (text) {\n      var text_tokens = text.split(' ');\n      var tmp = '';\n\n      var _iterator = _createForOfIteratorHelper(text_tokens),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var token = _step.value;\n\n          if (res.length < 2) {\n            if (tmp.length > threshold) {\n              res.push(token.slice(0, 9) + '..');\n              tmp = '';\n            }\n\n            if (tmp.length == 0) {\n              if (token.length <= threshold) {\n                tmp += token;\n              } else {\n                res.push(token.slice(0, 9) + '..');\n                tmp = '';\n              }\n            } else {\n              if (tmp.length + 1 + token.length <= threshold) {\n                tmp += ' ' + token;\n              } else {\n                res.push(tmp);\n                tmp = token;\n              }\n            }\n          } else {\n            if (tmp.length == 0) {\n              if (token.length <= threshold) {\n                tmp += token;\n              } else {\n                res.push(token.slice(0, 9) + '..');\n                tmp = '';\n              }\n            } else {\n              if (tmp.length + 1 + token.length <= threshold) {\n                tmp += ' ' + token;\n              } else {\n                res.push(tmp);\n                tmp = token;\n              }\n            }\n\n            break;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      if (tmp.length > 0) {\n        if (tmp.length > threshold) {\n          res.push(tmp.slice(0, 8) + '..');\n        } else {\n          res.push(tmp);\n        }\n      }\n    } else {\n      res = ['None'];\n    }\n\n    return res;\n  }\n\n  function appendOutlineToNode(node) {\n    return node.append('circle').attr('class', function (d) {\n      return \"outline nodetype_\".concat(d.properties.entity_type ? d.properties.entity_type : 'undefined');\n    }).attr('r', options.nodeRadius).style('fill', function (d) {\n      return '#78b3d0'; //    return options.nodeOutlineFillColor ? options.nodeOutlineFillColor : class2color(d.labels[0]);\n    }).style('stroke', function (d) {\n      return '#358eb8'; //    return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : class2darkenColor(d.labels[0]);\n    }).append('title').text(function (d) {\n      console.log('teeeee', d);\n      return d.properties.label;\n    });\n  }\n\n  function appendRingToNode(node) {\n    return node.append('circle').attr('class', 'ring').attr('r', options.nodeRadius * 1.16); // .append('title').text(function (d) {\n    //   return toString(d.label)\n    // })\n  }\n\n  function appendTextToNode(node) {\n    return node.append('text').attr('class', function (d) {\n      return 'text' + (icon(d) ? ' icon' : '');\n    }).attr('stroke', 'white').attr('font-size', function (d) {\n      return icon(d) ? options.nodeRadius + 'px' : '10px';\n    }).style('pointer-events', 'none').attr('text-anchor', 'middle').attr('y', function (d) {\n      return icon(d) ? parseInt(Math.round(options.nodeRadius * 0.32)) + 'px' : '4px';\n    }).html(function (d) {\n      var _icon = icon(d);\n\n      return _icon ? '&#x' + _icon : d.id;\n    });\n  }\n\n  function appendRandomDataToNode(d, maxNodesToGenerate) {\n    var data = randomD3Data(d, maxNodesToGenerate);\n    updateWithNeo4jData(data);\n  }\n\n  function appendRelationship() {\n    // exist removed relationships\n    relationship.exit().remove();\n    return relationship.enter().append('g').attr('class', 'relationship').on('dblclick', function (d) {\n      if (typeof options.onRelationshipDoubleClick === 'function') {\n        options.onRelationshipDoubleClick(d);\n      }\n    }).on('mouseenter', function (d) {\n      if (info) {\n        updateInfo(d);\n      }\n    });\n  }\n\n  function appendOutlineToRelationship(r) {\n    return r.append('path').attr('class', function (d) {\n      return \"outline nodetype_\".concat(d.properties.relationship_type ? d.properties.relationship_type : 'undefined');\n    }).attr('fill', '#a5abb6').attr('stroke', 'none');\n  }\n\n  function appendOverlayToRelationship(r) {\n    return r.append('path').attr('class', 'overlay');\n  }\n\n  function appendTextToRelationship(r) {\n    return r.append('text').attr('class', 'text').attr('fill', '#000000').attr('font-size', '10px').attr('pointer-events', 'none').attr('text-anchor', 'middle').attr('color', 'white').text(function (d) {\n      // console.log(d)\n      var mapping = d['properties']['mapping'];\n      return d['properties'][mapping];\n    });\n  }\n\n  function appendRelationshipToGraph() {\n    var relationship = appendRelationship(),\n        text = appendTextToRelationship(relationship),\n        outline = appendOutlineToRelationship(relationship),\n        overlay = appendOverlayToRelationship(relationship);\n    return {\n      outline: outline,\n      overlay: overlay,\n      relationship: relationship,\n      text: text\n    };\n  }\n\n  function class2color(cls) {\n    var color = classes2colors[cls];\n\n    if (!color) {\n      //            color = options.colors[Math.min(numClasses, options.colors.length - 1)];\n      color = options.colors[numClasses % options.colors.length];\n      classes2colors[cls] = color;\n      numClasses++;\n    }\n\n    return color;\n  }\n\n  function class2darkenColor(cls) {\n    return d3.rgb(class2color(cls)).darker(1);\n  }\n\n  function clearInfo() {\n    info.html('');\n  }\n\n  function color() {\n    return options.colors[options.colors.length * Math.random() << 0];\n  }\n\n  function colors() {\n    // d3.schemeCategory10,\n    // d3.schemeCategory20,\n    return ['#68bdf6', // light blue\n    '#6dce9e', // green #1\n    '#faafc2', // light pink\n    '#f2baf6', // purple\n    '#ff928c', // light red\n    '#fcea7e', // light yellow\n    '#ffc766', // light orange\n    '#405f9e', // navy blue\n    '#a5abb6', // dark gray\n    '#78cecb', // green #2,\n    '#b88cbb', // dark purple\n    '#ced2d9', // light gray\n    '#e84646', // dark red\n    '#fa5f86', // dark pink\n    '#ffab1a', // dark orange\n    '#fcda19', // dark yellow\n    '#797b80', // black\n    '#c9d96f', // pistacchio\n    '#47991f', // green #3\n    '#70edee', // turquoise\n    '#ff75ea' // pink\n    ];\n  }\n\n  function contains(array, id) {\n    var filter = array.filter(function (elem) {\n      return elem.id === id;\n    });\n    return filter.length > 0;\n  }\n\n  function defaultColor() {\n    return options.relationshipColor;\n  }\n\n  function defaultDarkenColor() {\n    return d3.rgb(options.colors[options.colors.length - 1]).darker(1);\n  }\n\n  function dragEnded(d) {\n    if (!d3.event.active) {\n      simulation.alphaTarget(0);\n    }\n\n    if (typeof options.onNodeDragEnd === 'function') {\n      options.onNodeDragEnd(d);\n    }\n  }\n\n  function dragged(d) {\n    stickNode(d);\n  }\n\n  function dragStarted(d) {\n    if (!d3.event.active) {\n      simulation.alphaTarget(0.3).restart();\n    }\n\n    d.fx = d.x;\n    d.fy = d.y;\n\n    if (typeof options.onNodeDragStart === 'function') {\n      options.onNodeDragStart(d);\n    }\n  }\n\n  function extend(obj1, obj2) {\n    var obj = {};\n    merge(obj, obj1);\n    merge(obj, obj2);\n    return obj;\n  }\n\n  function fontAwesomeIcons() {\n    return {\n      'glass': 'f000',\n      'music': 'f001',\n      'search': 'f002',\n      'envelope-o': 'f003',\n      'heart': 'f004',\n      'star': 'f005',\n      'star-o': 'f006',\n      'user': 'f007',\n      'film': 'f008',\n      'th-large': 'f009',\n      'th': 'f00a',\n      'th-list': 'f00b',\n      'check': 'f00c',\n      'remove,close,times': 'f00d',\n      'search-plus': 'f00e',\n      'search-minus': 'f010',\n      'power-off': 'f011',\n      'signal': 'f012',\n      'gear,cog': 'f013',\n      'trash-o': 'f014',\n      'home': 'f015',\n      'file-o': 'f016',\n      'clock-o': 'f017',\n      'road': 'f018',\n      'download': 'f019',\n      'arrow-circle-o-down': 'f01a',\n      'arrow-circle-o-up': 'f01b',\n      'inbox': 'f01c',\n      'play-circle-o': 'f01d',\n      'rotate-right,repeat': 'f01e',\n      'refresh': 'f021',\n      'list-alt': 'f022',\n      'lock': 'f023',\n      'flag': 'f024',\n      'headphones': 'f025',\n      'volume-off': 'f026',\n      'volume-down': 'f027',\n      'volume-up': 'f028',\n      'qrcode': 'f029',\n      'barcode': 'f02a',\n      'tag': 'f02b',\n      'tags': 'f02c',\n      'book': 'f02d',\n      'bookmark': 'f02e',\n      'print': 'f02f',\n      'camera': 'f030',\n      'font': 'f031',\n      'bold': 'f032',\n      'italic': 'f033',\n      'text-height': 'f034',\n      'text-width': 'f035',\n      'align-left': 'f036',\n      'align-center': 'f037',\n      'align-right': 'f038',\n      'align-justify': 'f039',\n      'list': 'f03a',\n      'dedent,outdent': 'f03b',\n      'indent': 'f03c',\n      'video-camera': 'f03d',\n      'photo,image,picture-o': 'f03e',\n      'pencil': 'f040',\n      'map-marker': 'f041',\n      'adjust': 'f042',\n      'tint': 'f043',\n      'edit,pencil-square-o': 'f044',\n      'share-square-o': 'f045',\n      'check-square-o': 'f046',\n      'arrows': 'f047',\n      'step-backward': 'f048',\n      'fast-backward': 'f049',\n      'backward': 'f04a',\n      'play': 'f04b',\n      'pause': 'f04c',\n      'stop': 'f04d',\n      'forward': 'f04e',\n      'fast-forward': 'f050',\n      'step-forward': 'f051',\n      'eject': 'f052',\n      'chevron-left': 'f053',\n      'chevron-right': 'f054',\n      'plus-circle': 'f055',\n      'minus-circle': 'f056',\n      'times-circle': 'f057',\n      'check-circle': 'f058',\n      'question-circle': 'f059',\n      'info-circle': 'f05a',\n      'crosshairs': 'f05b',\n      'times-circle-o': 'f05c',\n      'check-circle-o': 'f05d',\n      'ban': 'f05e',\n      'arrow-left': 'f060',\n      'arrow-right': 'f061',\n      'arrow-up': 'f062',\n      'arrow-down': 'f063',\n      'mail-forward,share': 'f064',\n      'expand': 'f065',\n      'compress': 'f066',\n      'plus': 'f067',\n      'minus': 'f068',\n      'asterisk': 'f069',\n      'exclamation-circle': 'f06a',\n      'gift': 'f06b',\n      'leaf': 'f06c',\n      'fire': 'f06d',\n      'eye': 'f06e',\n      'eye-slash': 'f070',\n      'warning,exclamation-triangle': 'f071',\n      'plane': 'f072',\n      'calendar': 'f073',\n      'random': 'f074',\n      'comment': 'f075',\n      'magnet': 'f076',\n      'chevron-up': 'f077',\n      'chevron-down': 'f078',\n      'retweet': 'f079',\n      'shopping-cart': 'f07a',\n      'folder': 'f07b',\n      'folder-open': 'f07c',\n      'arrows-v': 'f07d',\n      'arrows-h': 'f07e',\n      'bar-chart-o,bar-chart': 'f080',\n      'twitter-square': 'f081',\n      'facebook-square': 'f082',\n      'camera-retro': 'f083',\n      'key': 'f084',\n      'gears,cogs': 'f085',\n      'comments': 'f086',\n      'thumbs-o-up': 'f087',\n      'thumbs-o-down': 'f088',\n      'star-half': 'f089',\n      'heart-o': 'f08a',\n      'sign-out': 'f08b',\n      'linkedin-square': 'f08c',\n      'thumb-tack': 'f08d',\n      'external-link': 'f08e',\n      'sign-in': 'f090',\n      'trophy': 'f091',\n      'github-square': 'f092',\n      'upload': 'f093',\n      'lemon-o': 'f094',\n      'phone': 'f095',\n      'square-o': 'f096',\n      'bookmark-o': 'f097',\n      'phone-square': 'f098',\n      'twitter': 'f099',\n      'facebook-f,facebook': 'f09a',\n      'github': 'f09b',\n      'unlock': 'f09c',\n      'credit-card': 'f09d',\n      'feed,rss': 'f09e',\n      'hdd-o': 'f0a0',\n      'bullhorn': 'f0a1',\n      'bell': 'f0f3',\n      'certificate': 'f0a3',\n      'hand-o-right': 'f0a4',\n      'hand-o-left': 'f0a5',\n      'hand-o-up': 'f0a6',\n      'hand-o-down': 'f0a7',\n      'arrow-circle-left': 'f0a8',\n      'arrow-circle-right': 'f0a9',\n      'arrow-circle-up': 'f0aa',\n      'arrow-circle-down': 'f0ab',\n      'globe': 'f0ac',\n      'wrench': 'f0ad',\n      'tasks': 'f0ae',\n      'filter': 'f0b0',\n      'briefcase': 'f0b1',\n      'arrows-alt': 'f0b2',\n      'group,users': 'f0c0',\n      'chain,link': 'f0c1',\n      'cloud': 'f0c2',\n      'flask': 'f0c3',\n      'cut,scissors': 'f0c4',\n      'copy,files-o': 'f0c5',\n      'paperclip': 'f0c6',\n      'save,floppy-o': 'f0c7',\n      'square': 'f0c8',\n      'navicon,reorder,bars': 'f0c9',\n      'list-ul': 'f0ca',\n      'list-ol': 'f0cb',\n      'strikethrough': 'f0cc',\n      'underline': 'f0cd',\n      'table': 'f0ce',\n      'magic': 'f0d0',\n      'truck': 'f0d1',\n      'pinterest': 'f0d2',\n      'pinterest-square': 'f0d3',\n      'google-plus-square': 'f0d4',\n      'google-plus': 'f0d5',\n      'money': 'f0d6',\n      'caret-down': 'f0d7',\n      'caret-up': 'f0d8',\n      'caret-left': 'f0d9',\n      'caret-right': 'f0da',\n      'columns': 'f0db',\n      'unsorted,sort': 'f0dc',\n      'sort-down,sort-desc': 'f0dd',\n      'sort-up,sort-asc': 'f0de',\n      'envelope': 'f0e0',\n      'linkedin': 'f0e1',\n      'rotate-left,undo': 'f0e2',\n      'legal,gavel': 'f0e3',\n      'dashboard,tachometer': 'f0e4',\n      'comment-o': 'f0e5',\n      'comments-o': 'f0e6',\n      'flash,bolt': 'f0e7',\n      'sitemap': 'f0e8',\n      'umbrella': 'f0e9',\n      'paste,clipboard': 'f0ea',\n      'lightbulb-o': 'f0eb',\n      'exchange': 'f0ec',\n      'cloud-download': 'f0ed',\n      'cloud-upload': 'f0ee',\n      'user-md': 'f0f0',\n      'stethoscope': 'f0f1',\n      'suitcase': 'f0f2',\n      'bell-o': 'f0a2',\n      'coffee': 'f0f4',\n      'cutlery': 'f0f5',\n      'file-text-o': 'f0f6',\n      'building-o': 'f0f7',\n      'hospital-o': 'f0f8',\n      'ambulance': 'f0f9',\n      'medkit': 'f0fa',\n      'fighter-jet': 'f0fb',\n      'beer': 'f0fc',\n      'h-square': 'f0fd',\n      'plus-square': 'f0fe',\n      'angle-double-left': 'f100',\n      'angle-double-right': 'f101',\n      'angle-double-up': 'f102',\n      'angle-double-down': 'f103',\n      'angle-left': 'f104',\n      'angle-right': 'f105',\n      'angle-up': 'f106',\n      'angle-down': 'f107',\n      'desktop': 'f108',\n      'laptop': 'f109',\n      'tablet': 'f10a',\n      'mobile-phone,mobile': 'f10b',\n      'circle-o': 'f10c',\n      'quote-left': 'f10d',\n      'quote-right': 'f10e',\n      'spinner': 'f110',\n      'circle': 'f111',\n      'mail-reply,reply': 'f112',\n      'github-alt': 'f113',\n      'folder-o': 'f114',\n      'folder-open-o': 'f115',\n      'smile-o': 'f118',\n      'frown-o': 'f119',\n      'meh-o': 'f11a',\n      'gamepad': 'f11b',\n      'keyboard-o': 'f11c',\n      'flag-o': 'f11d',\n      'flag-checkered': 'f11e',\n      'terminal': 'f120',\n      'code': 'f121',\n      'mail-reply-all,reply-all': 'f122',\n      'star-half-empty,star-half-full,star-half-o': 'f123',\n      'location-arrow': 'f124',\n      'crop': 'f125',\n      'code-fork': 'f126',\n      'unlink,chain-broken': 'f127',\n      'question': 'f128',\n      'info': 'f129',\n      'exclamation': 'f12a',\n      'superscript': 'f12b',\n      'subscript': 'f12c',\n      'eraser': 'f12d',\n      'puzzle-piece': 'f12e',\n      'microphone': 'f130',\n      'microphone-slash': 'f131',\n      'shield': 'f132',\n      'calendar-o': 'f133',\n      'fire-extinguisher': 'f134',\n      'rocket': 'f135',\n      'maxcdn': 'f136',\n      'chevron-circle-left': 'f137',\n      'chevron-circle-right': 'f138',\n      'chevron-circle-up': 'f139',\n      'chevron-circle-down': 'f13a',\n      'html5': 'f13b',\n      'css3': 'f13c',\n      'anchor': 'f13d',\n      'unlock-alt': 'f13e',\n      'bullseye': 'f140',\n      'ellipsis-h': 'f141',\n      'ellipsis-v': 'f142',\n      'rss-square': 'f143',\n      'play-circle': 'f144',\n      'ticket': 'f145',\n      'minus-square': 'f146',\n      'minus-square-o': 'f147',\n      'level-up': 'f148',\n      'level-down': 'f149',\n      'check-square': 'f14a',\n      'pencil-square': 'f14b',\n      'external-link-square': 'f14c',\n      'share-square': 'f14d',\n      'compass': 'f14e',\n      'toggle-down,caret-square-o-down': 'f150',\n      'toggle-up,caret-square-o-up': 'f151',\n      'toggle-right,caret-square-o-right': 'f152',\n      'euro,eur': 'f153',\n      'gbp': 'f154',\n      'dollar,usd': 'f155',\n      'rupee,inr': 'f156',\n      'cny,rmb,yen,jpy': 'f157',\n      'ruble,rouble,rub': 'f158',\n      'won,krw': 'f159',\n      'bitcoin,btc': 'f15a',\n      'file': 'f15b',\n      'file-text': 'f15c',\n      'sort-alpha-asc': 'f15d',\n      'sort-alpha-desc': 'f15e',\n      'sort-amount-asc': 'f160',\n      'sort-amount-desc': 'f161',\n      'sort-numeric-asc': 'f162',\n      'sort-numeric-desc': 'f163',\n      'thumbs-up': 'f164',\n      'thumbs-down': 'f165',\n      'youtube-square': 'f166',\n      'youtube': 'f167',\n      'xing': 'f168',\n      'xing-square': 'f169',\n      'youtube-play': 'f16a',\n      'dropbox': 'f16b',\n      'stack-overflow': 'f16c',\n      'instagram': 'f16d',\n      'flickr': 'f16e',\n      'adn': 'f170',\n      'bitbucket': 'f171',\n      'bitbucket-square': 'f172',\n      'tumblr': 'f173',\n      'tumblr-square': 'f174',\n      'long-arrow-down': 'f175',\n      'long-arrow-up': 'f176',\n      'long-arrow-left': 'f177',\n      'long-arrow-right': 'f178',\n      'apple': 'f179',\n      'windows': 'f17a',\n      'android': 'f17b',\n      'linux': 'f17c',\n      'dribbble': 'f17d',\n      'skype': 'f17e',\n      'foursquare': 'f180',\n      'trello': 'f181',\n      'female': 'f182',\n      'male': 'f183',\n      'gittip,gratipay': 'f184',\n      'sun-o': 'f185',\n      'moon-o': 'f186',\n      'archive': 'f187',\n      'bug': 'f188',\n      'vk': 'f189',\n      'weibo': 'f18a',\n      'renren': 'f18b',\n      'pagelines': 'f18c',\n      'stack-exchange': 'f18d',\n      'arrow-circle-o-right': 'f18e',\n      'arrow-circle-o-left': 'f190',\n      'toggle-left,caret-square-o-left': 'f191',\n      'dot-circle-o': 'f192',\n      'wheelchair': 'f193',\n      'vimeo-square': 'f194',\n      'turkish-lira,try': 'f195',\n      'plus-square-o': 'f196',\n      'space-shuttle': 'f197',\n      'slack': 'f198',\n      'envelope-square': 'f199',\n      'wordpress': 'f19a',\n      'openid': 'f19b',\n      'institution,bank,university': 'f19c',\n      'mortar-board,graduation-cap': 'f19d',\n      'yahoo': 'f19e',\n      'google': 'f1a0',\n      'reddit': 'f1a1',\n      'reddit-square': 'f1a2',\n      'stumbleupon-circle': 'f1a3',\n      'stumbleupon': 'f1a4',\n      'delicious': 'f1a5',\n      'digg': 'f1a6',\n      'pied-piper-pp': 'f1a7',\n      'pied-piper-alt': 'f1a8',\n      'drupal': 'f1a9',\n      'joomla': 'f1aa',\n      'language': 'f1ab',\n      'fax': 'f1ac',\n      'building': 'f1ad',\n      'child': 'f1ae',\n      'paw': 'f1b0',\n      'spoon': 'f1b1',\n      'cube': 'f1b2',\n      'cubes': 'f1b3',\n      'behance': 'f1b4',\n      'behance-square': 'f1b5',\n      'steam': 'f1b6',\n      'steam-square': 'f1b7',\n      'recycle': 'f1b8',\n      'automobile,car': 'f1b9',\n      'cab,taxi': 'f1ba',\n      'tree': 'f1bb',\n      'spotify': 'f1bc',\n      'deviantart': 'f1bd',\n      'soundcloud': 'f1be',\n      'database': 'f1c0',\n      'file-pdf-o': 'f1c1',\n      'file-word-o': 'f1c2',\n      'file-excel-o': 'f1c3',\n      'file-powerpoint-o': 'f1c4',\n      'file-photo-o,file-picture-o,file-image-o': 'f1c5',\n      'file-zip-o,file-archive-o': 'f1c6',\n      'file-sound-o,file-audio-o': 'f1c7',\n      'file-movie-o,file-video-o': 'f1c8',\n      'file-code-o': 'f1c9',\n      'vine': 'f1ca',\n      'codepen': 'f1cb',\n      'jsfiddle': 'f1cc',\n      'life-bouy,life-buoy,life-saver,support,life-ring': 'f1cd',\n      'circle-o-notch': 'f1ce',\n      'ra,resistance,rebel': 'f1d0',\n      'ge,empire': 'f1d1',\n      'git-square': 'f1d2',\n      'git': 'f1d3',\n      'y-combinator-square,yc-square,hacker-news': 'f1d4',\n      'tencent-weibo': 'f1d5',\n      'qq': 'f1d6',\n      'wechat,weixin': 'f1d7',\n      'send,paper-plane': 'f1d8',\n      'send-o,paper-plane-o': 'f1d9',\n      'history': 'f1da',\n      'circle-thin': 'f1db',\n      'header': 'f1dc',\n      'paragraph': 'f1dd',\n      'sliders': 'f1de',\n      'share-alt': 'f1e0',\n      'share-alt-square': 'f1e1',\n      'bomb': 'f1e2',\n      'soccer-ball-o,futbol-o': 'f1e3',\n      'tty': 'f1e4',\n      'binoculars': 'f1e5',\n      'plug': 'f1e6',\n      'slideshare': 'f1e7',\n      'twitch': 'f1e8',\n      'yelp': 'f1e9',\n      'newspaper-o': 'f1ea',\n      'wifi': 'f1eb',\n      'calculator': 'f1ec',\n      'paypal': 'f1ed',\n      'google-wallet': 'f1ee',\n      'cc-visa': 'f1f0',\n      'cc-mastercard': 'f1f1',\n      'cc-discover': 'f1f2',\n      'cc-amex': 'f1f3',\n      'cc-paypal': 'f1f4',\n      'cc-stripe': 'f1f5',\n      'bell-slash': 'f1f6',\n      'bell-slash-o': 'f1f7',\n      'trash': 'f1f8',\n      'copyright': 'f1f9',\n      'at': 'f1fa',\n      'eyedropper': 'f1fb',\n      'paint-brush': 'f1fc',\n      'birthday-cake': 'f1fd',\n      'area-chart': 'f1fe',\n      'pie-chart': 'f200',\n      'line-chart': 'f201',\n      'lastfm': 'f202',\n      'lastfm-square': 'f203',\n      'toggle-off': 'f204',\n      'toggle-on': 'f205',\n      'bicycle': 'f206',\n      'bus': 'f207',\n      'ioxhost': 'f208',\n      'angellist': 'f209',\n      'cc': 'f20a',\n      'shekel,sheqel,ils': 'f20b',\n      'meanpath': 'f20c',\n      'buysellads': 'f20d',\n      'connectdevelop': 'f20e',\n      'dashcube': 'f210',\n      'forumbee': 'f211',\n      'leanpub': 'f212',\n      'sellsy': 'f213',\n      'shirtsinbulk': 'f214',\n      'simplybuilt': 'f215',\n      'skyatlas': 'f216',\n      'cart-plus': 'f217',\n      'cart-arrow-down': 'f218',\n      'diamond': 'f219',\n      'ship': 'f21a',\n      'user-secret': 'f21b',\n      'motorcycle': 'f21c',\n      'street-view': 'f21d',\n      'heartbeat': 'f21e',\n      'venus': 'f221',\n      'mars': 'f222',\n      'mercury': 'f223',\n      'intersex,transgender': 'f224',\n      'transgender-alt': 'f225',\n      'venus-double': 'f226',\n      'mars-double': 'f227',\n      'venus-mars': 'f228',\n      'mars-stroke': 'f229',\n      'mars-stroke-v': 'f22a',\n      'mars-stroke-h': 'f22b',\n      'neuter': 'f22c',\n      'genderless': 'f22d',\n      'facebook-official': 'f230',\n      'pinterest-p': 'f231',\n      'whatsapp': 'f232',\n      'server': 'f233',\n      'user-plus': 'f234',\n      'user-times': 'f235',\n      'hotel,bed': 'f236',\n      'viacoin': 'f237',\n      'train': 'f238',\n      'subway': 'f239',\n      'medium': 'f23a',\n      'yc,y-combinator': 'f23b',\n      'optin-monster': 'f23c',\n      'opencart': 'f23d',\n      'expeditedssl': 'f23e',\n      'battery-4,battery-full': 'f240',\n      'battery-3,battery-three-quarters': 'f241',\n      'battery-2,battery-half': 'f242',\n      'battery-1,battery-quarter': 'f243',\n      'battery-0,battery-empty': 'f244',\n      'mouse-pointer': 'f245',\n      'i-cursor': 'f246',\n      'object-group': 'f247',\n      'object-ungroup': 'f248',\n      'sticky-note': 'f249',\n      'sticky-note-o': 'f24a',\n      'cc-jcb': 'f24b',\n      'cc-diners-club': 'f24c',\n      'clone': 'f24d',\n      'balance-scale': 'f24e',\n      'hourglass-o': 'f250',\n      'hourglass-1,hourglass-start': 'f251',\n      'hourglass-2,hourglass-half': 'f252',\n      'hourglass-3,hourglass-end': 'f253',\n      'hourglass': 'f254',\n      'hand-grab-o,hand-rock-o': 'f255',\n      'hand-stop-o,hand-paper-o': 'f256',\n      'hand-scissors-o': 'f257',\n      'hand-lizard-o': 'f258',\n      'hand-spock-o': 'f259',\n      'hand-pointer-o': 'f25a',\n      'hand-peace-o': 'f25b',\n      'trademark': 'f25c',\n      'registered': 'f25d',\n      'creative-commons': 'f25e',\n      'gg': 'f260',\n      'gg-circle': 'f261',\n      'tripadvisor': 'f262',\n      'odnoklassniki': 'f263',\n      'odnoklassniki-square': 'f264',\n      'get-pocket': 'f265',\n      'wikipedia-w': 'f266',\n      'safari': 'f267',\n      'chrome': 'f268',\n      'firefox': 'f269',\n      'opera': 'f26a',\n      'internet-explorer': 'f26b',\n      'tv,television': 'f26c',\n      'contao': 'f26d',\n      '500px': 'f26e',\n      'amazon': 'f270',\n      'calendar-plus-o': 'f271',\n      'calendar-minus-o': 'f272',\n      'calendar-times-o': 'f273',\n      'calendar-check-o': 'f274',\n      'industry': 'f275',\n      'map-pin': 'f276',\n      'map-signs': 'f277',\n      'map-o': 'f278',\n      'map': 'f279',\n      'commenting': 'f27a',\n      'commenting-o': 'f27b',\n      'houzz': 'f27c',\n      'vimeo': 'f27d',\n      'black-tie': 'f27e',\n      'fonticons': 'f280',\n      'reddit-alien': 'f281',\n      'edge': 'f282',\n      'credit-card-alt': 'f283',\n      'codiepie': 'f284',\n      'modx': 'f285',\n      'fort-awesome': 'f286',\n      'usb': 'f287',\n      'product-hunt': 'f288',\n      'mixcloud': 'f289',\n      'scribd': 'f28a',\n      'pause-circle': 'f28b',\n      'pause-circle-o': 'f28c',\n      'stop-circle': 'f28d',\n      'stop-circle-o': 'f28e',\n      'shopping-bag': 'f290',\n      'shopping-basket': 'f291',\n      'hashtag': 'f292',\n      'bluetooth': 'f293',\n      'bluetooth-b': 'f294',\n      'percent': 'f295',\n      'gitlab': 'f296',\n      'wpbeginner': 'f297',\n      'wpforms': 'f298',\n      'envira': 'f299',\n      'universal-access': 'f29a',\n      'wheelchair-alt': 'f29b',\n      'question-circle-o': 'f29c',\n      'blind': 'f29d',\n      'audio-description': 'f29e',\n      'volume-control-phone': 'f2a0',\n      'braille': 'f2a1',\n      'assistive-listening-systems': 'f2a2',\n      'asl-interpreting,american-sign-language-interpreting': 'f2a3',\n      'deafness,hard-of-hearing,deaf': 'f2a4',\n      'glide': 'f2a5',\n      'glide-g': 'f2a6',\n      'signing,sign-language': 'f2a7',\n      'low-vision': 'f2a8',\n      'viadeo': 'f2a9',\n      'viadeo-square': 'f2aa',\n      'snapchat': 'f2ab',\n      'snapchat-ghost': 'f2ac',\n      'snapchat-square': 'f2ad',\n      'pied-piper': 'f2ae',\n      'first-order': 'f2b0',\n      'yoast': 'f2b1',\n      'themeisle': 'f2b2',\n      'google-plus-circle,google-plus-official': 'f2b3',\n      'fa,font-awesome': 'f2b4'\n    };\n  }\n\n  function icon(d) {\n    var code;\n\n    if (options.iconMap && options.showIcons && options.icons) {\n      if (options.icons[d.labels[0]] && options.iconMap[options.icons[d.labels[0]]]) {\n        code = options.iconMap[options.icons[d.labels[0]]];\n      } else if (options.iconMap[d.labels[0]]) {\n        code = options.iconMap[d.labels[0]];\n      } else if (options.icons[d.labels[0]]) {\n        code = options.icons[d.labels[0]];\n      }\n    }\n\n    return code;\n  }\n\n  function image(d) {\n    var i, imagesForLabel, img, imgLevel, label, labelPropertyValue, property, value;\n\n    if (options.images) {\n      imagesForLabel = options.imageMap[d.labels[0]];\n\n      if (imagesForLabel) {\n        imgLevel = 0;\n\n        for (i = 0; i < imagesForLabel.length; i++) {\n          labelPropertyValue = imagesForLabel[i].split('|');\n\n          switch (labelPropertyValue.length) {\n            case 3:\n              value = labelPropertyValue[2];\n\n            /* falls through */\n\n            case 2:\n              property = labelPropertyValue[1];\n\n            /* falls through */\n\n            case 1:\n              label = labelPropertyValue[0];\n          }\n\n          if (d.labels[0] === label && (!property || d.properties[property] !== undefined) && (!value || d.properties[property] === value)) {\n            if (labelPropertyValue.length > imgLevel) {\n              img = options.images[imagesForLabel[i]];\n              imgLevel = labelPropertyValue.length;\n            }\n          }\n        }\n      }\n    }\n\n    return img;\n  }\n\n  function init(_selector, _options) {\n    initIconMap();\n    merge(options, _options);\n\n    if (options.icons) {\n      options.showIcons = true;\n    }\n\n    if (!options.minCollision) {\n      options.minCollision = options.nodeRadius * 2;\n    }\n\n    initImageMap();\n    selector = _selector;\n    container = d3.select(selector);\n    container.attr('class', 'neo4jd3').html('');\n\n    if (options.infoPanel) {\n      info = appendInfoPanel(container);\n    }\n\n    appendGraph(container);\n    simulation = initSimulation();\n\n    if (options.neo4jData) {\n      loadNeo4jData(options.neo4jData);\n    } else if (options.neo4jDataUrl) {\n      loadNeo4jDataFromUrl(options.neo4jDataUrl);\n    } else {\n      console.error('Error: both neo4jData and neo4jDataUrl are empty!');\n    }\n  }\n\n  function initIconMap() {\n    Object.keys(options.iconMap).forEach(function (key, index) {\n      var keys = key.split(','),\n          value = options.iconMap[key];\n      keys.forEach(function (key) {\n        options.iconMap[key] = value;\n      });\n    });\n  }\n\n  function initImageMap() {\n    var key, keys, selector;\n\n    for (key in options.images) {\n      if (options.images.hasOwnProperty(key)) {\n        keys = key.split('|');\n\n        if (!options.imageMap[keys[0]]) {\n          options.imageMap[keys[0]] = [key];\n        } else {\n          options.imageMap[keys[0]].push(key);\n        }\n      }\n    }\n  }\n\n  function initSimulation() {\n    var simulation = d3.forceSimulation() //                           .velocityDecay(0.8)\n    //                           .force('x', d3.force().strength(0.002))\n    //                           .force('y', d3.force().strength(0.002))\n    .force('collide', d3.forceCollide().radius(function (d) {\n      return options.minCollision;\n    }).iterations(2)).force('charge', d3.forceManyBody().strength(-100)).force('link', d3.forceLink().id(function (d) {\n      return d.id;\n    }).distance(0).strength(.8)).force('center', d3.forceCenter(svg.node().parentElement.parentElement.clientWidth / 2, svg.node().parentElement.parentElement.clientHeight / 2)).on('tick', function () {\n      tick();\n    }).on('end', function () {\n      if (options.zoomFit && !justLoaded) {\n        justLoaded = true;\n        zoomFit(2);\n      }\n    });\n    return simulation;\n  }\n\n  function loadNeo4jData() {\n    nodes = [];\n    relationships = [];\n    updateWithNeo4jData(options.neo4jData);\n  }\n\n  function loadNeo4jDataFromUrl(neo4jDataUrl) {\n    nodes = [];\n    relationships = [];\n    d3.json(neo4jDataUrl, function (error, data) {\n      if (error) {\n        throw error;\n      }\n\n      updateWithNeo4jData(data);\n    });\n  }\n\n  function merge(target, source) {\n    Object.keys(source).forEach(function (property) {\n      target[property] = source[property];\n    });\n  }\n\n  function neo4jDataToD3Data(data) {\n    var graph = {\n      nodes: [],\n      relationships: []\n    };\n    data.results.forEach(function (result) {\n      result.data.forEach(function (data) {\n        data.graph.nodes.forEach(function (node) {\n          if (!contains(graph.nodes, node.id)) {\n            graph.nodes.push(node);\n          }\n        });\n        data.graph.relationships.forEach(function (relationship) {\n          relationship.source = relationship.startNode;\n          relationship.target = relationship.endNode;\n          graph.relationships.push(relationship);\n        });\n        data.graph.relationships.sort(function (a, b) {\n          if (a.source > b.source) {\n            return 1;\n          } else if (a.source < b.source) {\n            return -1;\n          } else {\n            if (a.target > b.target) {\n              return 1;\n            }\n\n            if (a.target < b.target) {\n              return -1;\n            } else {\n              return 0;\n            }\n          }\n        });\n\n        for (var i = 0; i < data.graph.relationships.length; i++) {\n          if (i !== 0 && data.graph.relationships[i].source === data.graph.relationships[i - 1].source && data.graph.relationships[i].target === data.graph.relationships[i - 1].target) {\n            data.graph.relationships[i].linknum = data.graph.relationships[i - 1].linknum + 1;\n          } else {\n            data.graph.relationships[i].linknum = 1;\n          }\n        }\n      });\n    });\n    return graph;\n  }\n\n  function randomD3Data(d, maxNodesToGenerate) {\n    var data = {\n      nodes: [],\n      relationships: []\n    },\n        i,\n        label,\n        node,\n        numNodes = (maxNodesToGenerate * Math.random() << 0) + 1,\n        relationship,\n        s = size();\n\n    for (i = 0; i < numNodes; i++) {\n      label = randomLabel();\n      node = {\n        id: s.nodes + 1 + i,\n        labels: [label],\n        properties: {\n          random: label\n        },\n        x: d.x,\n        y: d.y\n      };\n      data.nodes[data.nodes.length] = node;\n      relationship = {\n        id: s.relationships + 1 + i,\n        type: label.toUpperCase(),\n        startNode: d.id,\n        endNode: s.nodes + 1 + i,\n        properties: {\n          from: Date.now()\n        },\n        source: d.id,\n        target: s.nodes + 1 + i,\n        linknum: s.relationships + 1 + i\n      };\n      data.relationships[data.relationships.length] = relationship;\n    }\n\n    return data;\n  }\n\n  function randomLabel() {\n    var icons = Object.keys(options.iconMap);\n    return icons[icons.length * Math.random() << 0];\n  }\n\n  function rotate(cx, cy, x, y, angle) {\n    var radians = Math.PI / 180 * angle,\n        cos = Math.cos(radians),\n        sin = Math.sin(radians),\n        nx = cos * (x - cx) + sin * (y - cy) + cx,\n        ny = cos * (y - cy) - sin * (x - cx) + cy;\n    return {\n      x: nx,\n      y: ny\n    };\n  }\n\n  function rotatePoint(c, p, angle) {\n    return rotate(c.x, c.y, p.x, p.y, angle);\n  }\n\n  function rotation(source, target) {\n    return Math.atan2(target.y - source.y, target.x - source.x) * 180 / Math.PI;\n  }\n\n  function size() {\n    return {\n      nodes: nodes.length,\n      relationships: relationships.length\n    };\n  }\n  /*\n    function smoothTransform(elem, translate, scale) {\n        var animationMilliseconds = 5000,\n            timeoutMilliseconds = 50,\n            steps = parseInt(animationMilliseconds / timeoutMilliseconds);\n         setTimeout(function() {\n            smoothTransformStep(elem, translate, scale, timeoutMilliseconds, 1, steps);\n        }, timeoutMilliseconds);\n    }\n     function smoothTransformStep(elem, translate, scale, timeoutMilliseconds, step, steps) {\n        var progress = step / steps;\n         elem.attr('transform', 'translate(' + (translate[0] * progress) + ', ' + (translate[1] * progress) + ') scale(' + (scale * progress) + ')');\n         if (step < steps) {\n            setTimeout(function() {\n                smoothTransformStep(elem, translate, scale, timeoutMilliseconds, step + 1, steps);\n            }, timeoutMilliseconds);\n        }\n    }\n  */\n\n\n  function stickNode(d) {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  }\n\n  function tick() {\n    tickNodes();\n    tickRelationships();\n  }\n\n  function tickNodes() {\n    if (node) {\n      node.attr('transform', function (d) {\n        return 'translate(' + d.x + ', ' + d.y + ')';\n      });\n    }\n  }\n\n  function tickRelationships() {\n    if (relationship) {\n      relationship.attr('transform', function (d) {\n        var angle = rotation(d.source, d.target);\n        return 'translate(' + d.source.x + ', ' + d.source.y + ') rotate(' + angle + ')';\n      });\n      tickRelationshipsTexts();\n      tickRelationshipsOutlines();\n      tickRelationshipsOverlays();\n    }\n  }\n\n  function tickRelationshipsOutlines() {\n    relationship.each(function (relationship) {\n      var rel = d3.select(this),\n          outline = rel.select('.outline'),\n          text = rel.select('.text'),\n          bbox = text.node().getBBox(),\n          padding = 3;\n      outline.attr('d', function (d) {\n        var center = {\n          x: 0,\n          y: 0\n        },\n            angle = rotation(d.source, d.target),\n            textBoundingBox = text.node().getBBox(),\n            textPadding = 5,\n            u = unitaryVector(d.source, d.target),\n            textMargin = {\n          x: (d.target.x - d.source.x - (textBoundingBox.width + textPadding) * u.x) * 0.5,\n          y: (d.target.y - d.source.y - (textBoundingBox.width + textPadding) * u.y) * 0.5\n        },\n            n = unitaryNormalVector(d.source, d.target),\n            rotatedPointA1 = rotatePoint(center, {\n          x: 0 + (options.nodeRadius + 1) * u.x - n.x,\n          y: 0 + (options.nodeRadius + 1) * u.y - n.y\n        }, angle),\n            rotatedPointB1 = rotatePoint(center, {\n          x: textMargin.x - n.x,\n          y: textMargin.y - n.y\n        }, angle),\n            rotatedPointC1 = rotatePoint(center, {\n          x: textMargin.x,\n          y: textMargin.y\n        }, angle),\n            rotatedPointD1 = rotatePoint(center, {\n          x: 0 + (options.nodeRadius + 1) * u.x,\n          y: 0 + (options.nodeRadius + 1) * u.y\n        }, angle),\n            rotatedPointA2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - textMargin.x - n.x,\n          y: d.target.y - d.source.y - textMargin.y - n.y\n        }, angle),\n            rotatedPointB2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - n.x - u.x * options.arrowSize,\n          y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - n.y - u.y * options.arrowSize\n        }, angle),\n            rotatedPointC2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - n.x + (n.x - u.x) * options.arrowSize,\n          y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - n.y + (n.y - u.y) * options.arrowSize\n        }, angle),\n            rotatedPointD2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x,\n          y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y\n        }, angle),\n            rotatedPointE2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x + (-n.x - u.x) * options.arrowSize,\n          y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y + (-n.y - u.y) * options.arrowSize\n        }, angle),\n            rotatedPointF2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - u.x * options.arrowSize,\n          y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - u.y * options.arrowSize\n        }, angle),\n            rotatedPointG2 = rotatePoint(center, {\n          x: d.target.x - d.source.x - textMargin.x,\n          y: d.target.y - d.source.y - textMargin.y\n        }, angle);\n        return 'M ' + rotatedPointA1.x + ' ' + rotatedPointA1.y + ' L ' + rotatedPointB1.x + ' ' + rotatedPointB1.y + ' L ' + rotatedPointC1.x + ' ' + rotatedPointC1.y + ' L ' + rotatedPointD1.x + ' ' + rotatedPointD1.y + ' Z M ' + rotatedPointA2.x + ' ' + rotatedPointA2.y + ' L ' + rotatedPointB2.x + ' ' + rotatedPointB2.y + ' L ' + rotatedPointC2.x + ' ' + rotatedPointC2.y + ' L ' + rotatedPointD2.x + ' ' + rotatedPointD2.y + ' L ' + rotatedPointE2.x + ' ' + rotatedPointE2.y + ' L ' + rotatedPointF2.x + ' ' + rotatedPointF2.y + ' L ' + rotatedPointG2.x + ' ' + rotatedPointG2.y + ' Z';\n      });\n    });\n  }\n\n  function tickRelationshipsOverlays() {\n    relationshipOverlay.attr('d', function (d) {\n      var center = {\n        x: 0,\n        y: 0\n      },\n          angle = rotation(d.source, d.target),\n          n1 = unitaryNormalVector(d.source, d.target),\n          n = unitaryNormalVector(d.source, d.target, 50),\n          rotatedPointA = rotatePoint(center, {\n        x: 0 - n.x,\n        y: 0 - n.y\n      }, angle),\n          rotatedPointB = rotatePoint(center, {\n        x: d.target.x - d.source.x - n.x,\n        y: d.target.y - d.source.y - n.y\n      }, angle),\n          rotatedPointC = rotatePoint(center, {\n        x: d.target.x - d.source.x + n.x - n1.x,\n        y: d.target.y - d.source.y + n.y - n1.y\n      }, angle),\n          rotatedPointD = rotatePoint(center, {\n        x: 0 + n.x - n1.x,\n        y: 0 + n.y - n1.y\n      }, angle);\n      return 'M ' + rotatedPointA.x + ' ' + rotatedPointA.y + ' L ' + rotatedPointB.x + ' ' + rotatedPointB.y + ' L ' + rotatedPointC.x + ' ' + rotatedPointC.y + ' L ' + rotatedPointD.x + ' ' + rotatedPointD.y + ' Z';\n    });\n  }\n\n  function tickRelationshipsTexts() {\n    relationshipText.attr('transform', function (d) {\n      var angle = (rotation(d.source, d.target) + 360) % 360,\n          mirror = angle > 90 && angle < 270,\n          center = {\n        x: 0,\n        y: 0\n      },\n          n = unitaryNormalVector(d.source, d.target),\n          nWeight = mirror ? 2 : -3,\n          point = {\n        x: (d.target.x - d.source.x) * 0.5 + n.x * nWeight,\n        y: (d.target.y - d.source.y) * 0.5 + n.y * nWeight\n      },\n          rotatedPoint = rotatePoint(center, point, angle);\n      var translate_res = 'translate(' + rotatedPoint.x + ', ' + rotatedPoint.y + ')';\n\n      if (angle > 90 && angle <= 279) {\n        translate_res += ' rotate(180)';\n      }\n\n      return translate_res;\n    });\n  }\n\n  function toString(d) {\n    var s = d.labels ? d.labels[0] : d.type;\n    s += ' (<id>: ' + d.id;\n    Object.keys(d.properties).forEach(function (property) {\n      s += ', ' + property + ': ' + JSON.stringify(d.properties[property]);\n    });\n    s += ')';\n    return s;\n  }\n\n  function unitaryNormalVector(source, target, newLength) {\n    var center = {\n      x: 0,\n      y: 0\n    },\n        vector = unitaryVector(source, target, newLength);\n    return rotatePoint(center, vector, 90);\n  }\n\n  function unitaryVector(source, target, newLength) {\n    var length = Math.sqrt(Math.pow(target.x - source.x, 2) + Math.pow(target.y - source.y, 2)) / Math.sqrt(newLength || 1);\n    return {\n      x: (target.x - source.x) / length,\n      y: (target.y - source.y) / length\n    };\n  }\n\n  function updateWithD3Data(d3Data) {\n    updateNodesAndRelationships(d3Data.nodes, d3Data.relationships);\n  }\n\n  function updateWithNeo4jData(neo4jData) {\n    var d3Data = neo4jDataToD3Data(neo4jData);\n    updateWithD3Data(d3Data);\n  }\n\n  function updateInfo(d) {\n    clearInfo();\n\n    if (d.labels) {\n      appendInfoElementClass('class', d.labels[0]);\n    } else {\n      appendInfoElementRelationship('class', d.type);\n    }\n\n    appendInfoElementProperty('property', '&lt;id&gt;', d.id);\n    Object.keys(d.properties).forEach(function (property) {\n      appendInfoElementProperty('property', property, JSON.stringify(d.properties[property]));\n    });\n  }\n  /**\n   * Push arr2 to arr2 avoid duplicate of id\n   * @param {*} arr1 \n   * @param {*} arr2 \n   */\n\n\n  function arrayPush(arr1, arr2) {\n    var visited = {};\n    var ids = arr1.map(function (d) {\n      visited[d.id] = false;\n      return d.id;\n    });\n\n    for (var i = 0; i < arr2.length; i++) {\n      var tmpId = arr2[i].id;\n\n      if (!ids.includes(tmpId)) {\n        arr1.push(arr2[i]);\n        ids.push(tmpId);\n      } else {\n        visited[tmpId] = true;\n      }\n    } // remove non-visted values\n\n\n    var keys = Object.keys(visited);\n\n    for (var j = 0; j < keys.length; j++) {\n      var removeId = keys[j];\n\n      if (visited[removeId] == false) {\n        for (var k = 0; k < arr1.length; k++) {\n          if (arr1[k].id == removeId) {\n            arr1.splice(k, 1);\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  function updateNodes(n) {\n    // Array.prototype.push.apply(nodes, n)\n    arrayPush(nodes, n);\n    node = svgNodes.selectAll('.node').data(nodes, function (d) {\n      return d.id;\n    }); // .data(nodeIds)\n\n    var nodeEnter = appendNodeToGraph();\n    node = nodeEnter.merge(node);\n  }\n\n  function updateNodesAndRelationships(n, r) {\n    updateRelationships(r);\n    updateNodes(n);\n    simulation.nodes(nodes);\n    simulation.force('link').links(relationships);\n  }\n\n  function updateRelationships(r) {\n    // Array.prototype.push.apply(relationships, r)\n    arrayPush(relationships, r);\n    relationship = svgRelationships.selectAll('.relationship').data(relationships, function (d) {\n      return d.id;\n    });\n    var relationshipEnter = appendRelationshipToGraph();\n    relationship = relationshipEnter.relationship.merge(relationship);\n    relationshipOutline = svg.selectAll('.relationship .outline');\n    relationshipOutline = relationshipEnter.outline.merge(relationshipOutline);\n    relationshipOverlay = svg.selectAll('.relationship .overlay');\n    relationshipOverlay = relationshipEnter.overlay.merge(relationshipOverlay);\n    relationshipText = svg.selectAll('.relationship .text');\n    relationshipText = relationshipEnter.text.merge(relationshipText);\n  }\n\n  function version() {\n    return VERSION;\n  }\n\n  function zoomFit(transitionDuration) {\n    var bounds = svg.node().getBBox(),\n        parent = svg.node().parentElement.parentElement,\n        fullWidth = parent.clientWidth,\n        fullHeight = parent.clientHeight,\n        width = bounds.width,\n        height = bounds.height,\n        midX = bounds.x + width / 2,\n        midY = bounds.y + height / 2;\n\n    if (width === 0 || height === 0) {\n      return; // nothing to fit\n    }\n\n    svgScale = 0.85 / Math.max(width / fullWidth, height / fullHeight);\n    svgTranslate = [fullWidth / 2 - svgScale * midX, fullHeight / 2 - svgScale * midY];\n    svg.attr('transform', 'translate(' + svgTranslate[0] + ', ' + svgTranslate[1] + ') scale(' + svgScale + ')'); //        smoothTransform(svgTranslate, svgScale);\n  }\n\n  init(_selector, _options);\n  return {\n    appendRandomDataToNode: appendRandomDataToNode,\n    neo4jDataToD3Data: neo4jDataToD3Data,\n    randomD3Data: randomD3Data,\n    size: size,\n    updateWithD3Data: updateWithD3Data,\n    updateWithNeo4jData: updateWithNeo4jData,\n    version: version\n  };\n}\n\nexport default Neo4jD3;","map":{"version":3,"sources":["/Users/yameitu/Desktop/ICIRCLE/Smartfoodshed_VA_VC1/frontend/src/js/Neo4D3.js"],"names":["d3","Neo4jD3","_selector","_options","container","graph","info","node","nodes","relationship","relationshipOutline","relationshipOverlay","relationshipText","relationships","selector","simulation","svg","svgNodes","svgRelationships","svgScale","svgTranslate","classes2colors","justLoaded","numClasses","options","arrowSize","colors","highlight","undefined","iconMap","fontAwesomeIcons","icons","imageMap","images","infoPanel","minCollision","neo4jData","neo4jDataUrl","nodeOutlineFillColor","nodeRadius","relationshipColor","zoomFit","VERSION","appendGraph","append","attr","on","appendImageToNode","d","icon","image","appendInfoPanel","appendInfoElement","cls","isNode","property","value","elem","html","style","class2color","defaultColor","class2darkenColor","defaultDarkenColor","appendInfoElementClass","appendInfoElementProperty","appendInfoElementRelationship","appendNode","exit","remove","enter","i","classes","label","labels","length","class","properties","id","fx","fy","onNodeClick","stickNode","onNodeDoubleClick","updateInfo","onNodeMouseEnter","clearInfo","onNodeMouseLeave","call","drag","dragStarted","dragged","dragEnded","appendNodeToGraph","n","appendRingToNode","appendOutlineToNode","appendLabeltoNode","appendTextToNode","each","mapping","text_nodes","textDisplay","selection","select","text","threshold","res","text_tokens","split","tmp","token","push","slice","entity_type","console","log","parseInt","Math","round","_icon","appendRandomDataToNode","maxNodesToGenerate","data","randomD3Data","updateWithNeo4jData","appendRelationship","onRelationshipDoubleClick","appendOutlineToRelationship","r","relationship_type","appendOverlayToRelationship","appendTextToRelationship","appendRelationshipToGraph","outline","overlay","color","rgb","darker","random","contains","array","filter","event","active","alphaTarget","onNodeDragEnd","restart","x","y","onNodeDragStart","extend","obj1","obj2","obj","merge","code","showIcons","imagesForLabel","img","imgLevel","labelPropertyValue","init","initIconMap","initImageMap","initSimulation","loadNeo4jData","loadNeo4jDataFromUrl","error","Object","keys","forEach","key","index","hasOwnProperty","forceSimulation","force","forceCollide","radius","iterations","forceManyBody","strength","forceLink","distance","forceCenter","parentElement","clientWidth","clientHeight","tick","json","target","source","neo4jDataToD3Data","results","result","startNode","endNode","sort","a","b","linknum","numNodes","s","size","randomLabel","type","toUpperCase","from","Date","now","rotate","cx","cy","angle","radians","PI","cos","sin","nx","ny","rotatePoint","c","p","rotation","atan2","tickNodes","tickRelationships","tickRelationshipsTexts","tickRelationshipsOutlines","tickRelationshipsOverlays","rel","bbox","getBBox","padding","center","textBoundingBox","textPadding","u","unitaryVector","textMargin","width","unitaryNormalVector","rotatedPointA1","rotatedPointB1","rotatedPointC1","rotatedPointD1","rotatedPointA2","rotatedPointB2","rotatedPointC2","rotatedPointD2","rotatedPointE2","rotatedPointF2","rotatedPointG2","n1","rotatedPointA","rotatedPointB","rotatedPointC","rotatedPointD","mirror","nWeight","point","rotatedPoint","translate_res","toString","JSON","stringify","newLength","vector","sqrt","pow","updateWithD3Data","d3Data","updateNodesAndRelationships","arrayPush","arr1","arr2","visited","ids","map","tmpId","includes","j","removeId","k","splice","updateNodes","selectAll","nodeEnter","updateRelationships","links","relationshipEnter","version","transitionDuration","bounds","parent","fullWidth","fullHeight","height","midX","midY","max"],"mappings":"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","sourcesContent":["/* global d3, document */\n/* jshint latedef:nofunc */\nimport * as d3 from 'd3'\n\nfunction Neo4jD3 (_selector, _options) {\n  var container, graph, info, node, nodes, relationship, relationshipOutline, relationshipOverlay, relationshipText, relationships, selector, simulation, svg, svgNodes, svgRelationships, svgScale, svgTranslate,\n    classes2colors = {},\n    justLoaded = false,\n    numClasses = 0,\n    options = {\n      arrowSize: 4,\n      colors: colors(),\n      highlight: undefined,\n      iconMap: fontAwesomeIcons(),\n      icons: undefined,\n      imageMap: {},\n      images: undefined,\n      infoPanel: true,\n      minCollision: undefined,\n      neo4jData: undefined,\n      neo4jDataUrl: undefined,\n      nodeOutlineFillColor: undefined,\n      nodeRadius: 25,\n      relationshipColor: '#a5abb6',\n      zoomFit: false\n    },\n    VERSION = '0.0.1'\n\n\n  function appendGraph (container) {\n    svg= container.append('svg')\n      .attr('width', '100%')\n      .attr('height', '100%')\n      .attr('class', 'neo4jd3-graph')\n      .on('dblclick.zoom', null)\n      .append('g')\n      .attr('width', '100%')\n      .attr('height', '100%')\n       \n   \n      \n    svgRelationships = svg.append('g')\n      .attr('class', 'relationships')\n\n    svgNodes = svg.append('g')\n      .attr('class', 'nodes')\n  }\n\n  function appendImageToNode (node) {\n    return node.append('image')\n      .attr('height', function (d) {\n        return icon(d) ? '24px' : '30px'\n      })\n      .attr('x', function (d) {\n        return icon(d) ? '5px' : '-15px'\n      })\n      .attr('xlink:href', function (d) {\n        return image(d)\n      })\n      .attr('y', function (d) {\n        return icon(d) ? '5px' : '-16px'\n      })\n      .attr('width', function (d) {\n        return icon(d) ? '24px' : '30px'\n      })\n  }\n\n  function appendInfoPanel (container) {\n    return container.append('div')\n      .attr('class', 'neo4jd3-info')\n  }\n\n  function appendInfoElement (cls, isNode, property, value) {\n    var elem = info.append('a')\n\n    elem.attr('href', '#')\n      .attr('class', cls)\n      .html('<strong>' + property + '</strong>' + (value ? (': ' + value) : ''))\n\n    if (!value) {\n      elem.style('background-color', function (d) {\n        return options.nodeOutlineFillColor ? options.nodeOutlineFillColor : (isNode ? class2color(property) : defaultColor())\n      })\n        .style('border-color', function (d) {\n          return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : (isNode ? class2darkenColor(property) : defaultDarkenColor())\n        })\n        .style('color', function (d) {\n          return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : '#fff'\n        })\n    }\n  }\n\n  function appendInfoElementClass (cls, node) {\n    appendInfoElement(cls, true, node)\n  }\n\n  function appendInfoElementProperty (cls, property, value) {\n    appendInfoElement(cls, false, property, value)\n  }\n\n  function appendInfoElementRelationship (cls, relationship) {\n    appendInfoElement(cls, false, relationship)\n  }\n\n  function appendNode () {\n    // exist removed nodes\n    node.exit().remove()\n\n    return node.enter()\n      .append('g')\n      .attr('class', function (d) {\n        var highlight, i,\n          classes = 'node',\n          label = d.labels[0]\n\n        if (icon(d)) {\n          classes += ' node-icon'\n        }\n\n        if (image(d)) {\n          classes += ' node-image'\n        }\n\n        if (options.highlight) {\n          for (i = 0; i < options.highlight.length; i++) {\n            highlight = options.highlight[i]\n\n            if (d.labels[0] === highlight.class && d.properties[highlight.property] === highlight.value) {\n              classes += ' node-highlighted'\n              break\n            }\n          }\n        }\n\n        return classes\n      })\n      .attr('id', d=>`node-${d.id}`)\n      .on('click', function (d,i) {\n        d.fx = d.fy = null\n\n        if (typeof options.onNodeClick === 'function') {\n          options.onNodeClick(d,i)\n        }\n      })\n      .on('dblclick', function (d) {\n        stickNode(d)\n\n        if (typeof options.onNodeDoubleClick === 'function') {\n          options.onNodeDoubleClick(d)\n        }\n      })\n      .on('mouseenter', function (d) {\n        if (info) {\n          updateInfo(d)\n        }\n\n        if (typeof options.onNodeMouseEnter === 'function') {\n          options.onNodeMouseEnter(d)\n        }\n      })\n      .on('mouseleave', function (d) {\n        if (info) {\n          clearInfo(d)\n        }\n\n        if (typeof options.onNodeMouseLeave === 'function') {\n          options.onNodeMouseLeave(d)\n        }\n      })\n      .call(d3.drag()\n        .on('start', dragStarted)\n        .on('drag', dragged)\n        .on('end', dragEnded))\n  }\n\n  function appendNodeToGraph () {\n    var n = appendNode()\n\n    appendRingToNode(n)\n    appendOutlineToNode(n)\n    appendLabeltoNode(n)\n    if (options.icons) {\n      appendTextToNode(n)\n    }\n\n    if (options.images) {\n      appendImageToNode(n)\n    }\n\n    return n\n  }\n  function appendLabeltoNode (node) {\n    \n    node\n      .each(function (d) {\n        let mapping = d['properties']['mapping']\n        const text_nodes = textDisplay(d['properties'][mapping])\n        const selection = d3.select(this)\n        if (text_nodes.length == 1) {\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '0')\n            .style('font-size', '10px')\n            .style('text-anchor', 'middle')\n            .style('fill', 'white')\n            .style('pointer-events', 'none')\n            .style('font-weight', 'bold')\n            .text(text_nodes[0])\n        } else if (text_nodes.length == 2) {\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '-4')\n            .style('font-size', '10px')\n            .style('text-anchor', 'middle')\n            .style('pointer-events', 'none')\n            .style('fill', 'white')\n            .style('font-weight', 'bold')\n            .text(text_nodes[0])\n\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '12')\n            .style('font-size', '10px')\n            .style('text-anchor', 'middle')\n            .style('pointer-events', 'none')\n            .style('fill', 'white')\n            .style('font-weight', 'bold')\n            .text(text_nodes[1])\n        } else {\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '-12')\n            .style('font-size', '10px')\n            .style('pointer-events', 'none')\n            .style('text-anchor', 'middle')\n            .style('fill', 'white')\n            .style('font-weight', 'bold')\n            .text(text_nodes[0])\n\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '0')\n            .style('font-size', '10px')\n            .style('text-anchor', 'middle')\n            .style('pointer-events', 'none')\n            .style('fill', 'white')\n            .style('font-weight', 'bold')\n            .text(text_nodes[1])\n\n          selection.append('text')\n            .attr('x', '0')\n            .attr('y', '12')\n            .style('font-size', '10px')\n            .style('pointer-events', 'none')\n            .style('text-anchor', 'middle')\n            .style('fill', 'white')\n            .style('font-weight', 'bold')\n            .text(text_nodes[2])\n        }\n      })\n    // const text_nodes = textDisplay()\n  }\n\n  function textDisplay (text) {\n    let threshold = 9\n\n    let res = []\n    if (text) {\n      let text_tokens = text.split(' ')\n      let tmp = ''\n      for (let token of text_tokens) {\n        if (res.length < 2) {\n          if (tmp.length > threshold) {\n            res.push(token.slice(0, 9) + '..')\n            tmp = ''\n          }\n          if (tmp.length == 0) {\n            if (token.length <= threshold) {\n              tmp += token\n            } else {\n              res.push(token.slice(0, 9) + '..')\n              tmp = ''\n            }\n          } else {\n            if (tmp.length + 1 + token.length <= threshold) {\n              tmp += ' ' + token\n            } else {\n              res.push(tmp)\n              tmp = token\n            }\n          }\n        } else {\n          if (tmp.length == 0) {\n            if (token.length <= threshold) {\n              tmp += token\n            } else {\n              res.push(token.slice(0, 9) + '..')\n              tmp = ''\n            }\n          } else {\n            if (tmp.length + 1 + token.length <= threshold) {\n              tmp += ' ' + token\n            } else {\n              res.push(tmp)\n              tmp = token\n            }\n          }\n          break\n        }\n      }\n      if (tmp.length > 0) {\n        if (tmp.length > threshold) {\n          res.push(tmp.slice(0, 8) + '..')\n        } else {\n          res.push(tmp)\n        }\n      }\n    }else {\n      res = ['None']\n    }\n    return res\n  }\n\n  function appendOutlineToNode (node) {\n    return node.append('circle')\n      .attr('class', d=>`outline nodetype_${d.properties.entity_type?d.properties.entity_type:'undefined'}`)\n      .attr('r', options.nodeRadius)\n      .style('fill', function (d) {\n        return '#78b3d0'\n        //    return options.nodeOutlineFillColor ? options.nodeOutlineFillColor : class2color(d.labels[0]);\n      })\n      .style('stroke', function (d) {\n        return '#358eb8'\n        //    return options.nodeOutlineFillColor ? class2darkenColor(options.nodeOutlineFillColor) : class2darkenColor(d.labels[0]);\n      })\n      .append('title').text(function (d) {\n        console.log('teeeee', d)\n        return d.properties.label\n      })\n  }\n\n  function appendRingToNode (node) {\n    return node.append('circle')\n      .attr('class', 'ring')\n      .attr('r', options.nodeRadius * 1.16)\n      // .append('title').text(function (d) {\n      //   return toString(d.label)\n      // })\n  }\n\n  function appendTextToNode (node) {\n    return node.append('text')\n      .attr('class', function (d) {\n        return 'text' + (icon(d) ? ' icon' : '')\n      })\n      .attr('stroke', 'white')\n      .attr('font-size', function (d) {\n        return icon(d) ? (options.nodeRadius + 'px') : '10px'\n      })\n      .style('pointer-events', 'none')\n      .attr('text-anchor', 'middle')\n      .attr('y', function (d) {\n        return icon(d) ? (parseInt(Math.round(options.nodeRadius * 0.32)) + 'px') : '4px'\n      })\n      .html(function (d) {\n        var _icon = icon(d)\n        return _icon ? '&#x' + _icon : d.id\n      })\n\n  }\n\n  function appendRandomDataToNode (d, maxNodesToGenerate) {\n    var data = randomD3Data(d, maxNodesToGenerate)\n    updateWithNeo4jData(data)\n  }\n\n  function appendRelationship () {\n    // exist removed relationships\n    relationship.exit().remove()\n    return relationship.enter()\n      .append('g')\n      .attr('class', 'relationship')\n      .on('dblclick', function (d) {\n        if (typeof options.onRelationshipDoubleClick === 'function') {\n          options.onRelationshipDoubleClick(d)\n        }\n      })\n      .on('mouseenter', function (d) {\n        if (info) {\n          updateInfo(d)\n        }\n      })\n  }\n\n  function appendOutlineToRelationship (r) {\n    return r.append('path')\n      .attr('class', d=>`outline nodetype_${d.properties.relationship_type?d.properties.relationship_type:'undefined'}`)\n      .attr('fill', '#a5abb6')\n      .attr('stroke', 'none')\n  }\n\n  function appendOverlayToRelationship (r) {\n    return r.append('path')\n      .attr('class', 'overlay')\n  }\n\n  function appendTextToRelationship (r) {\n    return r.append('text')\n      .attr('class', 'text')\n      .attr('fill', '#000000')\n      .attr('font-size', '10px')\n      .attr('pointer-events', 'none')\n      .attr('text-anchor', 'middle')\n      .attr('color', 'white')\n      .text(function (d) {\n        // console.log(d)\n        let mapping = d['properties']['mapping']\n        return d['properties'][mapping]\n      })\n  }\n\n  function appendRelationshipToGraph () {\n    var relationship = appendRelationship(),\n      text = appendTextToRelationship(relationship),\n      outline = appendOutlineToRelationship(relationship),\n      overlay = appendOverlayToRelationship(relationship)\n\n    return {\n      outline: outline,\n      overlay: overlay,\n      relationship: relationship,\n      text: text\n    }\n  }\n\n  function class2color (cls) {\n    var color = classes2colors[cls]\n\n    if (!color) {\n      //            color = options.colors[Math.min(numClasses, options.colors.length - 1)];\n      color = options.colors[numClasses % options.colors.length]\n      classes2colors[cls] = color\n      numClasses++\n    }\n\n    return color\n  }\n\n  function class2darkenColor (cls) {\n    return d3.rgb(class2color(cls)).darker(1)\n  }\n\n  function clearInfo () {\n    info.html('')\n  }\n\n  function color () {\n    return options.colors[options.colors.length * Math.random() << 0]\n  }\n\n  function colors () {\n    // d3.schemeCategory10,\n    // d3.schemeCategory20,\n    return [\n      '#68bdf6', // light blue\n      '#6dce9e', // green #1\n      '#faafc2', // light pink\n      '#f2baf6', // purple\n      '#ff928c', // light red\n      '#fcea7e', // light yellow\n      '#ffc766', // light orange\n      '#405f9e', // navy blue\n      '#a5abb6', // dark gray\n      '#78cecb', // green #2,\n      '#b88cbb', // dark purple\n      '#ced2d9', // light gray\n      '#e84646', // dark red\n      '#fa5f86', // dark pink\n      '#ffab1a', // dark orange\n      '#fcda19', // dark yellow\n      '#797b80', // black\n      '#c9d96f', // pistacchio\n      '#47991f', // green #3\n      '#70edee', // turquoise\n      '#ff75ea' // pink\n    ]\n  }\n\n  function contains (array, id) {\n    var filter = array.filter(function (elem) {\n      return elem.id === id\n    })\n\n    return filter.length > 0\n  }\n\n  function defaultColor () {\n    return options.relationshipColor\n  }\n\n  function defaultDarkenColor () {\n    return d3.rgb(options.colors[options.colors.length - 1]).darker(1)\n  }\n\n  function dragEnded (d) {\n    if (!d3.event.active) {\n      simulation.alphaTarget(0)\n    }\n\n    if (typeof options.onNodeDragEnd === 'function') {\n      options.onNodeDragEnd(d)\n    }\n  }\n\n  function dragged (d) {\n    stickNode(d)\n  }\n\n  function dragStarted (d) {\n    if (!d3.event.active) {\n      simulation.alphaTarget(0.3).restart()\n    }\n\n    d.fx = d.x\n    d.fy = d.y\n\n    if (typeof options.onNodeDragStart === 'function') {\n      options.onNodeDragStart(d)\n    }\n  }\n\n  function extend (obj1, obj2) {\n    var obj = {}\n\n    merge(obj, obj1)\n    merge(obj, obj2)\n\n    return obj\n  }\n\n  function fontAwesomeIcons () {\n    return {'glass': 'f000', 'music': 'f001', 'search': 'f002', 'envelope-o': 'f003', 'heart': 'f004', 'star': 'f005', 'star-o': 'f006', 'user': 'f007', 'film': 'f008', 'th-large': 'f009', 'th': 'f00a', 'th-list': 'f00b', 'check': 'f00c', 'remove,close,times': 'f00d', 'search-plus': 'f00e', 'search-minus': 'f010', 'power-off': 'f011', 'signal': 'f012', 'gear,cog': 'f013', 'trash-o': 'f014', 'home': 'f015', 'file-o': 'f016', 'clock-o': 'f017', 'road': 'f018', 'download': 'f019', 'arrow-circle-o-down': 'f01a', 'arrow-circle-o-up': 'f01b', 'inbox': 'f01c', 'play-circle-o': 'f01d', 'rotate-right,repeat': 'f01e', 'refresh': 'f021', 'list-alt': 'f022', 'lock': 'f023', 'flag': 'f024', 'headphones': 'f025', 'volume-off': 'f026', 'volume-down': 'f027', 'volume-up': 'f028', 'qrcode': 'f029', 'barcode': 'f02a', 'tag': 'f02b', 'tags': 'f02c', 'book': 'f02d', 'bookmark': 'f02e', 'print': 'f02f', 'camera': 'f030', 'font': 'f031', 'bold': 'f032', 'italic': 'f033', 'text-height': 'f034', 'text-width': 'f035', 'align-left': 'f036', 'align-center': 'f037', 'align-right': 'f038', 'align-justify': 'f039', 'list': 'f03a', 'dedent,outdent': 'f03b', 'indent': 'f03c', 'video-camera': 'f03d', 'photo,image,picture-o': 'f03e', 'pencil': 'f040', 'map-marker': 'f041', 'adjust': 'f042', 'tint': 'f043', 'edit,pencil-square-o': 'f044', 'share-square-o': 'f045', 'check-square-o': 'f046', 'arrows': 'f047', 'step-backward': 'f048', 'fast-backward': 'f049', 'backward': 'f04a', 'play': 'f04b', 'pause': 'f04c', 'stop': 'f04d', 'forward': 'f04e', 'fast-forward': 'f050', 'step-forward': 'f051', 'eject': 'f052', 'chevron-left': 'f053', 'chevron-right': 'f054', 'plus-circle': 'f055', 'minus-circle': 'f056', 'times-circle': 'f057', 'check-circle': 'f058', 'question-circle': 'f059', 'info-circle': 'f05a', 'crosshairs': 'f05b', 'times-circle-o': 'f05c', 'check-circle-o': 'f05d', 'ban': 'f05e', 'arrow-left': 'f060', 'arrow-right': 'f061', 'arrow-up': 'f062', 'arrow-down': 'f063', 'mail-forward,share': 'f064', 'expand': 'f065', 'compress': 'f066', 'plus': 'f067', 'minus': 'f068', 'asterisk': 'f069', 'exclamation-circle': 'f06a', 'gift': 'f06b', 'leaf': 'f06c', 'fire': 'f06d', 'eye': 'f06e', 'eye-slash': 'f070', 'warning,exclamation-triangle': 'f071', 'plane': 'f072', 'calendar': 'f073', 'random': 'f074', 'comment': 'f075', 'magnet': 'f076', 'chevron-up': 'f077', 'chevron-down': 'f078', 'retweet': 'f079', 'shopping-cart': 'f07a', 'folder': 'f07b', 'folder-open': 'f07c', 'arrows-v': 'f07d', 'arrows-h': 'f07e', 'bar-chart-o,bar-chart': 'f080', 'twitter-square': 'f081', 'facebook-square': 'f082', 'camera-retro': 'f083', 'key': 'f084', 'gears,cogs': 'f085', 'comments': 'f086', 'thumbs-o-up': 'f087', 'thumbs-o-down': 'f088', 'star-half': 'f089', 'heart-o': 'f08a', 'sign-out': 'f08b', 'linkedin-square': 'f08c', 'thumb-tack': 'f08d', 'external-link': 'f08e', 'sign-in': 'f090', 'trophy': 'f091', 'github-square': 'f092', 'upload': 'f093', 'lemon-o': 'f094', 'phone': 'f095', 'square-o': 'f096', 'bookmark-o': 'f097', 'phone-square': 'f098', 'twitter': 'f099', 'facebook-f,facebook': 'f09a', 'github': 'f09b', 'unlock': 'f09c', 'credit-card': 'f09d', 'feed,rss': 'f09e', 'hdd-o': 'f0a0', 'bullhorn': 'f0a1', 'bell': 'f0f3', 'certificate': 'f0a3', 'hand-o-right': 'f0a4', 'hand-o-left': 'f0a5', 'hand-o-up': 'f0a6', 'hand-o-down': 'f0a7', 'arrow-circle-left': 'f0a8', 'arrow-circle-right': 'f0a9', 'arrow-circle-up': 'f0aa', 'arrow-circle-down': 'f0ab', 'globe': 'f0ac', 'wrench': 'f0ad', 'tasks': 'f0ae', 'filter': 'f0b0', 'briefcase': 'f0b1', 'arrows-alt': 'f0b2', 'group,users': 'f0c0', 'chain,link': 'f0c1', 'cloud': 'f0c2', 'flask': 'f0c3', 'cut,scissors': 'f0c4', 'copy,files-o': 'f0c5', 'paperclip': 'f0c6', 'save,floppy-o': 'f0c7', 'square': 'f0c8', 'navicon,reorder,bars': 'f0c9', 'list-ul': 'f0ca', 'list-ol': 'f0cb', 'strikethrough': 'f0cc', 'underline': 'f0cd', 'table': 'f0ce', 'magic': 'f0d0', 'truck': 'f0d1', 'pinterest': 'f0d2', 'pinterest-square': 'f0d3', 'google-plus-square': 'f0d4', 'google-plus': 'f0d5', 'money': 'f0d6', 'caret-down': 'f0d7', 'caret-up': 'f0d8', 'caret-left': 'f0d9', 'caret-right': 'f0da', 'columns': 'f0db', 'unsorted,sort': 'f0dc', 'sort-down,sort-desc': 'f0dd', 'sort-up,sort-asc': 'f0de', 'envelope': 'f0e0', 'linkedin': 'f0e1', 'rotate-left,undo': 'f0e2', 'legal,gavel': 'f0e3', 'dashboard,tachometer': 'f0e4', 'comment-o': 'f0e5', 'comments-o': 'f0e6', 'flash,bolt': 'f0e7', 'sitemap': 'f0e8', 'umbrella': 'f0e9', 'paste,clipboard': 'f0ea', 'lightbulb-o': 'f0eb', 'exchange': 'f0ec', 'cloud-download': 'f0ed', 'cloud-upload': 'f0ee', 'user-md': 'f0f0', 'stethoscope': 'f0f1', 'suitcase': 'f0f2', 'bell-o': 'f0a2', 'coffee': 'f0f4', 'cutlery': 'f0f5', 'file-text-o': 'f0f6', 'building-o': 'f0f7', 'hospital-o': 'f0f8', 'ambulance': 'f0f9', 'medkit': 'f0fa', 'fighter-jet': 'f0fb', 'beer': 'f0fc', 'h-square': 'f0fd', 'plus-square': 'f0fe', 'angle-double-left': 'f100', 'angle-double-right': 'f101', 'angle-double-up': 'f102', 'angle-double-down': 'f103', 'angle-left': 'f104', 'angle-right': 'f105', 'angle-up': 'f106', 'angle-down': 'f107', 'desktop': 'f108', 'laptop': 'f109', 'tablet': 'f10a', 'mobile-phone,mobile': 'f10b', 'circle-o': 'f10c', 'quote-left': 'f10d', 'quote-right': 'f10e', 'spinner': 'f110', 'circle': 'f111', 'mail-reply,reply': 'f112', 'github-alt': 'f113', 'folder-o': 'f114', 'folder-open-o': 'f115', 'smile-o': 'f118', 'frown-o': 'f119', 'meh-o': 'f11a', 'gamepad': 'f11b', 'keyboard-o': 'f11c', 'flag-o': 'f11d', 'flag-checkered': 'f11e', 'terminal': 'f120', 'code': 'f121', 'mail-reply-all,reply-all': 'f122', 'star-half-empty,star-half-full,star-half-o': 'f123', 'location-arrow': 'f124', 'crop': 'f125', 'code-fork': 'f126', 'unlink,chain-broken': 'f127', 'question': 'f128', 'info': 'f129', 'exclamation': 'f12a', 'superscript': 'f12b', 'subscript': 'f12c', 'eraser': 'f12d', 'puzzle-piece': 'f12e', 'microphone': 'f130', 'microphone-slash': 'f131', 'shield': 'f132', 'calendar-o': 'f133', 'fire-extinguisher': 'f134', 'rocket': 'f135', 'maxcdn': 'f136', 'chevron-circle-left': 'f137', 'chevron-circle-right': 'f138', 'chevron-circle-up': 'f139', 'chevron-circle-down': 'f13a', 'html5': 'f13b', 'css3': 'f13c', 'anchor': 'f13d', 'unlock-alt': 'f13e', 'bullseye': 'f140', 'ellipsis-h': 'f141', 'ellipsis-v': 'f142', 'rss-square': 'f143', 'play-circle': 'f144', 'ticket': 'f145', 'minus-square': 'f146', 'minus-square-o': 'f147', 'level-up': 'f148', 'level-down': 'f149', 'check-square': 'f14a', 'pencil-square': 'f14b', 'external-link-square': 'f14c', 'share-square': 'f14d', 'compass': 'f14e', 'toggle-down,caret-square-o-down': 'f150', 'toggle-up,caret-square-o-up': 'f151', 'toggle-right,caret-square-o-right': 'f152', 'euro,eur': 'f153', 'gbp': 'f154', 'dollar,usd': 'f155', 'rupee,inr': 'f156', 'cny,rmb,yen,jpy': 'f157', 'ruble,rouble,rub': 'f158', 'won,krw': 'f159', 'bitcoin,btc': 'f15a', 'file': 'f15b', 'file-text': 'f15c', 'sort-alpha-asc': 'f15d', 'sort-alpha-desc': 'f15e', 'sort-amount-asc': 'f160', 'sort-amount-desc': 'f161', 'sort-numeric-asc': 'f162', 'sort-numeric-desc': 'f163', 'thumbs-up': 'f164', 'thumbs-down': 'f165', 'youtube-square': 'f166', 'youtube': 'f167', 'xing': 'f168', 'xing-square': 'f169', 'youtube-play': 'f16a', 'dropbox': 'f16b', 'stack-overflow': 'f16c', 'instagram': 'f16d', 'flickr': 'f16e', 'adn': 'f170', 'bitbucket': 'f171', 'bitbucket-square': 'f172', 'tumblr': 'f173', 'tumblr-square': 'f174', 'long-arrow-down': 'f175', 'long-arrow-up': 'f176', 'long-arrow-left': 'f177', 'long-arrow-right': 'f178', 'apple': 'f179', 'windows': 'f17a', 'android': 'f17b', 'linux': 'f17c', 'dribbble': 'f17d', 'skype': 'f17e', 'foursquare': 'f180', 'trello': 'f181', 'female': 'f182', 'male': 'f183', 'gittip,gratipay': 'f184', 'sun-o': 'f185', 'moon-o': 'f186', 'archive': 'f187', 'bug': 'f188', 'vk': 'f189', 'weibo': 'f18a', 'renren': 'f18b', 'pagelines': 'f18c', 'stack-exchange': 'f18d', 'arrow-circle-o-right': 'f18e', 'arrow-circle-o-left': 'f190', 'toggle-left,caret-square-o-left': 'f191', 'dot-circle-o': 'f192', 'wheelchair': 'f193', 'vimeo-square': 'f194', 'turkish-lira,try': 'f195', 'plus-square-o': 'f196', 'space-shuttle': 'f197', 'slack': 'f198', 'envelope-square': 'f199', 'wordpress': 'f19a', 'openid': 'f19b', 'institution,bank,university': 'f19c', 'mortar-board,graduation-cap': 'f19d', 'yahoo': 'f19e', 'google': 'f1a0', 'reddit': 'f1a1', 'reddit-square': 'f1a2', 'stumbleupon-circle': 'f1a3', 'stumbleupon': 'f1a4', 'delicious': 'f1a5', 'digg': 'f1a6', 'pied-piper-pp': 'f1a7', 'pied-piper-alt': 'f1a8', 'drupal': 'f1a9', 'joomla': 'f1aa', 'language': 'f1ab', 'fax': 'f1ac', 'building': 'f1ad', 'child': 'f1ae', 'paw': 'f1b0', 'spoon': 'f1b1', 'cube': 'f1b2', 'cubes': 'f1b3', 'behance': 'f1b4', 'behance-square': 'f1b5', 'steam': 'f1b6', 'steam-square': 'f1b7', 'recycle': 'f1b8', 'automobile,car': 'f1b9', 'cab,taxi': 'f1ba', 'tree': 'f1bb', 'spotify': 'f1bc', 'deviantart': 'f1bd', 'soundcloud': 'f1be', 'database': 'f1c0', 'file-pdf-o': 'f1c1', 'file-word-o': 'f1c2', 'file-excel-o': 'f1c3', 'file-powerpoint-o': 'f1c4', 'file-photo-o,file-picture-o,file-image-o': 'f1c5', 'file-zip-o,file-archive-o': 'f1c6', 'file-sound-o,file-audio-o': 'f1c7', 'file-movie-o,file-video-o': 'f1c8', 'file-code-o': 'f1c9', 'vine': 'f1ca', 'codepen': 'f1cb', 'jsfiddle': 'f1cc', 'life-bouy,life-buoy,life-saver,support,life-ring': 'f1cd', 'circle-o-notch': 'f1ce', 'ra,resistance,rebel': 'f1d0', 'ge,empire': 'f1d1', 'git-square': 'f1d2', 'git': 'f1d3', 'y-combinator-square,yc-square,hacker-news': 'f1d4', 'tencent-weibo': 'f1d5', 'qq': 'f1d6', 'wechat,weixin': 'f1d7', 'send,paper-plane': 'f1d8', 'send-o,paper-plane-o': 'f1d9', 'history': 'f1da', 'circle-thin': 'f1db', 'header': 'f1dc', 'paragraph': 'f1dd', 'sliders': 'f1de', 'share-alt': 'f1e0', 'share-alt-square': 'f1e1', 'bomb': 'f1e2', 'soccer-ball-o,futbol-o': 'f1e3', 'tty': 'f1e4', 'binoculars': 'f1e5', 'plug': 'f1e6', 'slideshare': 'f1e7', 'twitch': 'f1e8', 'yelp': 'f1e9', 'newspaper-o': 'f1ea', 'wifi': 'f1eb', 'calculator': 'f1ec', 'paypal': 'f1ed', 'google-wallet': 'f1ee', 'cc-visa': 'f1f0', 'cc-mastercard': 'f1f1', 'cc-discover': 'f1f2', 'cc-amex': 'f1f3', 'cc-paypal': 'f1f4', 'cc-stripe': 'f1f5', 'bell-slash': 'f1f6', 'bell-slash-o': 'f1f7', 'trash': 'f1f8', 'copyright': 'f1f9', 'at': 'f1fa', 'eyedropper': 'f1fb', 'paint-brush': 'f1fc', 'birthday-cake': 'f1fd', 'area-chart': 'f1fe', 'pie-chart': 'f200', 'line-chart': 'f201', 'lastfm': 'f202', 'lastfm-square': 'f203', 'toggle-off': 'f204', 'toggle-on': 'f205', 'bicycle': 'f206', 'bus': 'f207', 'ioxhost': 'f208', 'angellist': 'f209', 'cc': 'f20a', 'shekel,sheqel,ils': 'f20b', 'meanpath': 'f20c', 'buysellads': 'f20d', 'connectdevelop': 'f20e', 'dashcube': 'f210', 'forumbee': 'f211', 'leanpub': 'f212', 'sellsy': 'f213', 'shirtsinbulk': 'f214', 'simplybuilt': 'f215', 'skyatlas': 'f216', 'cart-plus': 'f217', 'cart-arrow-down': 'f218', 'diamond': 'f219', 'ship': 'f21a', 'user-secret': 'f21b', 'motorcycle': 'f21c', 'street-view': 'f21d', 'heartbeat': 'f21e', 'venus': 'f221', 'mars': 'f222', 'mercury': 'f223', 'intersex,transgender': 'f224', 'transgender-alt': 'f225', 'venus-double': 'f226', 'mars-double': 'f227', 'venus-mars': 'f228', 'mars-stroke': 'f229', 'mars-stroke-v': 'f22a', 'mars-stroke-h': 'f22b', 'neuter': 'f22c', 'genderless': 'f22d', 'facebook-official': 'f230', 'pinterest-p': 'f231', 'whatsapp': 'f232', 'server': 'f233', 'user-plus': 'f234', 'user-times': 'f235', 'hotel,bed': 'f236', 'viacoin': 'f237', 'train': 'f238', 'subway': 'f239', 'medium': 'f23a', 'yc,y-combinator': 'f23b', 'optin-monster': 'f23c', 'opencart': 'f23d', 'expeditedssl': 'f23e', 'battery-4,battery-full': 'f240', 'battery-3,battery-three-quarters': 'f241', 'battery-2,battery-half': 'f242', 'battery-1,battery-quarter': 'f243', 'battery-0,battery-empty': 'f244', 'mouse-pointer': 'f245', 'i-cursor': 'f246', 'object-group': 'f247', 'object-ungroup': 'f248', 'sticky-note': 'f249', 'sticky-note-o': 'f24a', 'cc-jcb': 'f24b', 'cc-diners-club': 'f24c', 'clone': 'f24d', 'balance-scale': 'f24e', 'hourglass-o': 'f250', 'hourglass-1,hourglass-start': 'f251', 'hourglass-2,hourglass-half': 'f252', 'hourglass-3,hourglass-end': 'f253', 'hourglass': 'f254', 'hand-grab-o,hand-rock-o': 'f255', 'hand-stop-o,hand-paper-o': 'f256', 'hand-scissors-o': 'f257', 'hand-lizard-o': 'f258', 'hand-spock-o': 'f259', 'hand-pointer-o': 'f25a', 'hand-peace-o': 'f25b', 'trademark': 'f25c', 'registered': 'f25d', 'creative-commons': 'f25e', 'gg': 'f260', 'gg-circle': 'f261', 'tripadvisor': 'f262', 'odnoklassniki': 'f263', 'odnoklassniki-square': 'f264', 'get-pocket': 'f265', 'wikipedia-w': 'f266', 'safari': 'f267', 'chrome': 'f268', 'firefox': 'f269', 'opera': 'f26a', 'internet-explorer': 'f26b', 'tv,television': 'f26c', 'contao': 'f26d', '500px': 'f26e', 'amazon': 'f270', 'calendar-plus-o': 'f271', 'calendar-minus-o': 'f272', 'calendar-times-o': 'f273', 'calendar-check-o': 'f274', 'industry': 'f275', 'map-pin': 'f276', 'map-signs': 'f277', 'map-o': 'f278', 'map': 'f279', 'commenting': 'f27a', 'commenting-o': 'f27b', 'houzz': 'f27c', 'vimeo': 'f27d', 'black-tie': 'f27e', 'fonticons': 'f280', 'reddit-alien': 'f281', 'edge': 'f282', 'credit-card-alt': 'f283', 'codiepie': 'f284', 'modx': 'f285', 'fort-awesome': 'f286', 'usb': 'f287', 'product-hunt': 'f288', 'mixcloud': 'f289', 'scribd': 'f28a', 'pause-circle': 'f28b', 'pause-circle-o': 'f28c', 'stop-circle': 'f28d', 'stop-circle-o': 'f28e', 'shopping-bag': 'f290', 'shopping-basket': 'f291', 'hashtag': 'f292', 'bluetooth': 'f293', 'bluetooth-b': 'f294', 'percent': 'f295', 'gitlab': 'f296', 'wpbeginner': 'f297', 'wpforms': 'f298', 'envira': 'f299', 'universal-access': 'f29a', 'wheelchair-alt': 'f29b', 'question-circle-o': 'f29c', 'blind': 'f29d', 'audio-description': 'f29e', 'volume-control-phone': 'f2a0', 'braille': 'f2a1', 'assistive-listening-systems': 'f2a2', 'asl-interpreting,american-sign-language-interpreting': 'f2a3', 'deafness,hard-of-hearing,deaf': 'f2a4', 'glide': 'f2a5', 'glide-g': 'f2a6', 'signing,sign-language': 'f2a7', 'low-vision': 'f2a8', 'viadeo': 'f2a9', 'viadeo-square': 'f2aa', 'snapchat': 'f2ab', 'snapchat-ghost': 'f2ac', 'snapchat-square': 'f2ad', 'pied-piper': 'f2ae', 'first-order': 'f2b0', 'yoast': 'f2b1', 'themeisle': 'f2b2', 'google-plus-circle,google-plus-official': 'f2b3', 'fa,font-awesome': 'f2b4'}\n  }\n\n  function icon (d) {\n    var code\n\n    if (options.iconMap && options.showIcons && options.icons) {\n      if (options.icons[d.labels[0]] && options.iconMap[options.icons[d.labels[0]]]) {\n        code = options.iconMap[options.icons[d.labels[0]]]\n      } else if (options.iconMap[d.labels[0]]) {\n        code = options.iconMap[d.labels[0]]\n      } else if (options.icons[d.labels[0]]) {\n        code = options.icons[d.labels[0]]\n      }\n    }\n\n    return code\n  }\n\n  function image (d) {\n    var i, imagesForLabel, img, imgLevel, label, labelPropertyValue, property, value\n\n    if (options.images) {\n      imagesForLabel = options.imageMap[d.labels[0]]\n\n      if (imagesForLabel) {\n        imgLevel = 0\n\n        for (i = 0; i < imagesForLabel.length; i++) {\n          labelPropertyValue = imagesForLabel[i].split('|')\n\n          switch (labelPropertyValue.length) {\n            case 3:\n              value = labelPropertyValue[2]\n              /* falls through */\n            case 2:\n              property = labelPropertyValue[1]\n              /* falls through */\n            case 1:\n              label = labelPropertyValue[0]\n          }\n\n          if (d.labels[0] === label &&\n                        (!property || d.properties[property] !== undefined) &&\n                        (!value || d.properties[property] === value)) {\n            if (labelPropertyValue.length > imgLevel) {\n              img = options.images[imagesForLabel[i]]\n              imgLevel = labelPropertyValue.length\n            }\n          }\n        }\n      }\n    }\n\n    return img\n  }\n\n  function init (_selector, _options) {\n    initIconMap()\n\n    merge(options, _options)\n\n    if (options.icons) {\n      options.showIcons = true\n    }\n\n    if (!options.minCollision) {\n      options.minCollision = options.nodeRadius*2\n    }\n\n    initImageMap()\n\n    selector = _selector\n\n    container = d3.select(selector)\n\n    container.attr('class', 'neo4jd3')\n      .html('')\n\n    if (options.infoPanel) {\n      info = appendInfoPanel(container)\n    }\n\n    appendGraph(container)\n\n    simulation = initSimulation()\n\n    if (options.neo4jData) {\n      loadNeo4jData(options.neo4jData)\n    } else if (options.neo4jDataUrl) {\n      loadNeo4jDataFromUrl(options.neo4jDataUrl)\n    } else {\n      console.error('Error: both neo4jData and neo4jDataUrl are empty!')\n    }\n  }\n\n  function initIconMap () {\n    Object.keys(options.iconMap).forEach(function (key, index) {\n      var keys = key.split(','),\n        value = options.iconMap[key]\n\n      keys.forEach(function (key) {\n        options.iconMap[key] = value\n      })\n    })\n  }\n\n  function initImageMap () {\n    var key, keys, selector\n\n    for (key in options.images) {\n      if (options.images.hasOwnProperty(key)) {\n        keys = key.split('|')\n\n        if (!options.imageMap[keys[0]]) {\n          options.imageMap[keys[0]] = [key]\n        } else {\n          options.imageMap[keys[0]].push(key)\n        }\n      }\n    }\n  }\n\n  function initSimulation () {\n    var simulation = d3.forceSimulation()\n    //                           .velocityDecay(0.8)\n    //                           .force('x', d3.force().strength(0.002))\n    //                           .force('y', d3.force().strength(0.002))\n      .force('collide', d3.forceCollide().radius(function (d) {\n        return options.minCollision\n      }).iterations(2))\n      .force('charge', d3.forceManyBody().strength(-100))\n      .force('link', d3.forceLink().id(function (d) {\n        return d.id\n      }).distance(0).strength(.8))\n      .force('center', d3.forceCenter(svg.node().parentElement.parentElement.clientWidth / 2, svg.node().parentElement.parentElement.clientHeight / 2))\n      .on('tick', function () {\n        tick()\n      })\n      .on('end', function () {\n        if (options.zoomFit && !justLoaded) {\n          justLoaded = true\n          zoomFit(2)\n        }\n      })\n\n    return simulation\n  }\n\n  function loadNeo4jData () {\n    nodes = []\n    relationships = []\n\n    updateWithNeo4jData(options.neo4jData)\n  }\n\n  function loadNeo4jDataFromUrl (neo4jDataUrl) {\n    nodes = []\n    relationships = []\n\n    d3.json(neo4jDataUrl, function (error, data) {\n      if (error) {\n        throw error\n      }\n\n      updateWithNeo4jData(data)\n    })\n  }\n\n  function merge (target, source) {\n    Object.keys(source).forEach(function (property) {\n      target[property] = source[property]\n    })\n  }\n\n  function neo4jDataToD3Data (data) {\n    var graph = {\n      nodes: [],\n      relationships: []\n    }\n\n    data.results.forEach(function (result) {\n      result.data.forEach(function (data) {\n        data.graph.nodes.forEach(function (node) {\n          if (!contains(graph.nodes, node.id)) {\n            graph.nodes.push(node)\n          }\n        })\n\n        data.graph.relationships.forEach(function (relationship) {\n          relationship.source = relationship.startNode\n          relationship.target = relationship.endNode\n          graph.relationships.push(relationship)\n        })\n\n        data.graph.relationships.sort(function (a, b) {\n          if (a.source > b.source) {\n            return 1\n          } else if (a.source < b.source) {\n            return -1\n          } else {\n            if (a.target > b.target) {\n              return 1\n            }\n\n            if (a.target < b.target) {\n              return -1\n            } else {\n              return 0\n            }\n          }\n        })\n\n        for (var i = 0; i < data.graph.relationships.length; i++) {\n          if (i !== 0 && data.graph.relationships[i].source === data.graph.relationships[i - 1].source && data.graph.relationships[i].target === data.graph.relationships[i - 1].target) {\n            data.graph.relationships[i].linknum = data.graph.relationships[i - 1].linknum + 1\n          } else {\n            data.graph.relationships[i].linknum = 1\n          }\n        }\n      })\n    })\n\n    return graph\n  }\n\n  function randomD3Data (d, maxNodesToGenerate) {\n    var data = {\n        nodes: [],\n        relationships: []\n      },\n      i,\n      label,\n      node,\n      numNodes = (maxNodesToGenerate * Math.random() << 0) + 1,\n      relationship,\n      s = size()\n\n    for (i = 0; i < numNodes; i++) {\n      label = randomLabel()\n\n      node = {\n        id: s.nodes + 1 + i,\n        labels: [label],\n        properties: {\n          random: label\n        },\n        x: d.x,\n        y: d.y\n      }\n\n      data.nodes[data.nodes.length] = node\n\n      relationship = {\n        id: s.relationships + 1 + i,\n        type: label.toUpperCase(),\n        startNode: d.id,\n        endNode: s.nodes + 1 + i,\n        properties: {\n          from: Date.now()\n        },\n        source: d.id,\n        target: s.nodes + 1 + i,\n        linknum: s.relationships + 1 + i\n      }\n\n      data.relationships[data.relationships.length] = relationship\n    }\n\n    return data\n  }\n\n  function randomLabel () {\n    var icons = Object.keys(options.iconMap)\n    return icons[icons.length * Math.random() << 0]\n  }\n\n  function rotate (cx, cy, x, y, angle) {\n    var radians = (Math.PI / 180) * angle,\n      cos = Math.cos(radians),\n      sin = Math.sin(radians),\n      nx = (cos * (x - cx)) + (sin * (y - cy)) + cx,\n      ny = (cos * (y - cy)) - (sin * (x - cx)) + cy\n\n    return { x: nx, y: ny }\n  }\n\n  function rotatePoint (c, p, angle) {\n    return rotate(c.x, c.y, p.x, p.y, angle)\n  }\n\n  function rotation (source, target) {\n    return Math.atan2(target.y - source.y, target.x - source.x) * 180 / Math.PI\n  }\n\n  function size () {\n    return {\n      nodes: nodes.length,\n      relationships: relationships.length\n    }\n  }\n  /*\n    function smoothTransform(elem, translate, scale) {\n        var animationMilliseconds = 5000,\n            timeoutMilliseconds = 50,\n            steps = parseInt(animationMilliseconds / timeoutMilliseconds);\n\n        setTimeout(function() {\n            smoothTransformStep(elem, translate, scale, timeoutMilliseconds, 1, steps);\n        }, timeoutMilliseconds);\n    }\n\n    function smoothTransformStep(elem, translate, scale, timeoutMilliseconds, step, steps) {\n        var progress = step / steps;\n\n        elem.attr('transform', 'translate(' + (translate[0] * progress) + ', ' + (translate[1] * progress) + ') scale(' + (scale * progress) + ')');\n\n        if (step < steps) {\n            setTimeout(function() {\n                smoothTransformStep(elem, translate, scale, timeoutMilliseconds, step + 1, steps);\n            }, timeoutMilliseconds);\n        }\n    }\n*/\n  function stickNode (d) {\n    d.fx = d3.event.x\n    d.fy = d3.event.y\n  }\n\n  function tick () {\n    tickNodes()\n    tickRelationships()\n  }\n\n  function tickNodes () {\n    if (node) {\n      node.attr('transform', function (d) {\n        return 'translate(' + d.x + ', ' + d.y + ')'\n      })\n    }\n  }\n\n  function tickRelationships () {\n    if (relationship) {\n      relationship.attr('transform', function (d) {\n        var angle = rotation(d.source, d.target)\n        return 'translate(' + d.source.x + ', ' + d.source.y + ') rotate(' + angle + ')'\n      })\n\n      tickRelationshipsTexts()\n      tickRelationshipsOutlines()\n      tickRelationshipsOverlays()\n    }\n  }\n\n  function tickRelationshipsOutlines () {\n    relationship.each(function (relationship) {\n      var rel = d3.select(this),\n        outline = rel.select('.outline'),\n        text = rel.select('.text'),\n        bbox = text.node().getBBox(),\n        padding = 3\n\n      outline.attr('d', function (d) {\n        var center = { x: 0, y: 0 },\n          angle = rotation(d.source, d.target),\n          textBoundingBox = text.node().getBBox(),\n          textPadding = 5,\n          u = unitaryVector(d.source, d.target),\n          textMargin = { x: (d.target.x - d.source.x - (textBoundingBox.width + textPadding) * u.x) * 0.5, y: (d.target.y - d.source.y - (textBoundingBox.width + textPadding) * u.y) * 0.5 },\n          n = unitaryNormalVector(d.source, d.target),\n          rotatedPointA1 = rotatePoint(center, { x: 0 + (options.nodeRadius + 1) * u.x - n.x, y: 0 + (options.nodeRadius + 1) * u.y - n.y }, angle),\n          rotatedPointB1 = rotatePoint(center, { x: textMargin.x - n.x, y: textMargin.y - n.y }, angle),\n          rotatedPointC1 = rotatePoint(center, { x: textMargin.x, y: textMargin.y }, angle),\n          rotatedPointD1 = rotatePoint(center, { x: 0 + (options.nodeRadius + 1) * u.x, y: 0 + (options.nodeRadius + 1) * u.y }, angle),\n          rotatedPointA2 = rotatePoint(center, { x: d.target.x - d.source.x - textMargin.x - n.x, y: d.target.y - d.source.y - textMargin.y - n.y }, angle),\n          rotatedPointB2 = rotatePoint(center, { x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - n.x - u.x * options.arrowSize, y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - n.y - u.y * options.arrowSize }, angle),\n          rotatedPointC2 = rotatePoint(center, { x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - n.x + (n.x - u.x) * options.arrowSize, y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - n.y + (n.y - u.y) * options.arrowSize }, angle),\n          rotatedPointD2 = rotatePoint(center, { x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x, y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y }, angle),\n          rotatedPointE2 = rotatePoint(center, { x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x + (-n.x - u.x) * options.arrowSize, y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y + (-n.y - u.y) * options.arrowSize }, angle),\n          rotatedPointF2 = rotatePoint(center, { x: d.target.x - d.source.x - (options.nodeRadius + 1) * u.x - u.x * options.arrowSize, y: d.target.y - d.source.y - (options.nodeRadius + 1) * u.y - u.y * options.arrowSize }, angle),\n          rotatedPointG2 = rotatePoint(center, { x: d.target.x - d.source.x - textMargin.x, y: d.target.y - d.source.y - textMargin.y }, angle)\n\n        return 'M ' + rotatedPointA1.x + ' ' + rotatedPointA1.y +\n                       ' L ' + rotatedPointB1.x + ' ' + rotatedPointB1.y +\n                       ' L ' + rotatedPointC1.x + ' ' + rotatedPointC1.y +\n                       ' L ' + rotatedPointD1.x + ' ' + rotatedPointD1.y +\n                       ' Z M ' + rotatedPointA2.x + ' ' + rotatedPointA2.y +\n                       ' L ' + rotatedPointB2.x + ' ' + rotatedPointB2.y +\n                       ' L ' + rotatedPointC2.x + ' ' + rotatedPointC2.y +\n                       ' L ' + rotatedPointD2.x + ' ' + rotatedPointD2.y +\n                       ' L ' + rotatedPointE2.x + ' ' + rotatedPointE2.y +\n                       ' L ' + rotatedPointF2.x + ' ' + rotatedPointF2.y +\n                       ' L ' + rotatedPointG2.x + ' ' + rotatedPointG2.y +\n                       ' Z'\n      })\n    })\n  }\n\n  function tickRelationshipsOverlays () {\n    relationshipOverlay.attr('d', function (d) {\n      var center = { x: 0, y: 0 },\n        angle = rotation(d.source, d.target),\n        n1 = unitaryNormalVector(d.source, d.target),\n        n = unitaryNormalVector(d.source, d.target, 50),\n        rotatedPointA = rotatePoint(center, { x: 0 - n.x, y: 0 - n.y }, angle),\n        rotatedPointB = rotatePoint(center, { x: d.target.x - d.source.x - n.x, y: d.target.y - d.source.y - n.y }, angle),\n        rotatedPointC = rotatePoint(center, { x: d.target.x - d.source.x + n.x - n1.x, y: d.target.y - d.source.y + n.y - n1.y }, angle),\n        rotatedPointD = rotatePoint(center, { x: 0 + n.x - n1.x, y: 0 + n.y - n1.y }, angle)\n\n      return 'M ' + rotatedPointA.x + ' ' + rotatedPointA.y +\n                   ' L ' + rotatedPointB.x + ' ' + rotatedPointB.y +\n                   ' L ' + rotatedPointC.x + ' ' + rotatedPointC.y +\n                   ' L ' + rotatedPointD.x + ' ' + rotatedPointD.y +\n                   ' Z'\n    })\n  }\n\n  function tickRelationshipsTexts () {\n    relationshipText.attr('transform', function (d) {\n      var angle = (rotation(d.source, d.target) + 360) % 360,\n        mirror = angle > 90 && angle < 270,\n        center = { x: 0, y: 0 },\n        n = unitaryNormalVector(d.source, d.target),\n        nWeight = mirror ? 2 : -3,\n        point = { x: (d.target.x - d.source.x) * 0.5 + n.x * nWeight, y: (d.target.y - d.source.y) * 0.5 + n.y * nWeight },\n        rotatedPoint = rotatePoint(center, point, angle)\n      let translate_res = 'translate(' + rotatedPoint.x + ', ' + rotatedPoint.y + ')'\n      if (angle > 90 && angle <= 279){\n        translate_res += ' rotate(180)'\n      }\n      return translate_res\n    })\n  }\n\n  function toString (d) {\n    var s = d.labels ? d.labels[0] : d.type\n\n    s += ' (<id>: ' + d.id\n\n    Object.keys(d.properties).forEach(function (property) {\n      s += ', ' + property + ': ' + JSON.stringify(d.properties[property])\n    })\n\n    s += ')'\n\n    return s\n  }\n\n  function unitaryNormalVector (source, target, newLength) {\n    var center = { x: 0, y: 0 },\n      vector = unitaryVector(source, target, newLength)\n\n    return rotatePoint(center, vector, 90)\n  }\n\n  function unitaryVector (source, target, newLength) {\n    var length = Math.sqrt(Math.pow(target.x - source.x, 2) + Math.pow(target.y - source.y, 2)) / Math.sqrt(newLength || 1)\n\n    return {\n      x: (target.x - source.x) / length,\n      y: (target.y - source.y) / length\n    }\n  }\n\n  function updateWithD3Data (d3Data) {\n    updateNodesAndRelationships(d3Data.nodes, d3Data.relationships)\n  }\n\n  function updateWithNeo4jData (neo4jData) {\n    var d3Data = neo4jDataToD3Data(neo4jData)\n    updateWithD3Data(d3Data)\n  }\n\n  function updateInfo (d) {\n    clearInfo()\n\n    if (d.labels) {\n      appendInfoElementClass('class', d.labels[0])\n    } else {\n      appendInfoElementRelationship('class', d.type)\n    }\n\n    appendInfoElementProperty('property', '&lt;id&gt;', d.id)\n\n    Object.keys(d.properties).forEach(function (property) {\n      appendInfoElementProperty('property', property, JSON.stringify(d.properties[property]))\n    })\n  }\n\n  /**\n   * Push arr2 to arr2 avoid duplicate of id\n   * @param {*} arr1 \n   * @param {*} arr2 \n   */\n  function arrayPush(arr1, arr2){\n    let visited = {}\n    let ids = arr1.map(d => {\n      visited[d.id] = false  \n      return d.id\n    })\n    \n    for(let i = 0; i < arr2.length;i++){\n      const tmpId = arr2[i].id\n      if(!ids.includes(tmpId)){\n        arr1.push(arr2[i])\n        ids.push(tmpId)\n      }else{\n        visited[tmpId] = true\n      }\n    }\n\n    // remove non-visted values\n    const keys = Object.keys(visited)\n    for (let j = 0; j < keys.length; j++) {\n      let removeId = keys[j]\n      if(visited[removeId] == false){\n        for (let k = 0; k < arr1.length; k++) {\n          if(arr1[k].id == removeId){\n            arr1.splice(k, 1)\n            break\n          }\n        }\n      }\n    }\n  }\n\n  function updateNodes (n) {\n    // Array.prototype.push.apply(nodes, n)\n    arrayPush(nodes, n)\n    node = svgNodes.selectAll('.node')\n      .data(nodes, function(d){return d.id})\n      // .data(nodeIds)\n    var nodeEnter = appendNodeToGraph()\n    node = nodeEnter.merge(node)\n  }\n\n  function updateNodesAndRelationships (n, r) {\n    updateRelationships(r)\n    updateNodes(n)\n\n    simulation.nodes(nodes)\n    simulation.force('link').links(relationships)\n  }\n\n  function updateRelationships (r) {\n    // Array.prototype.push.apply(relationships, r)\n    arrayPush(relationships, r)\n    relationship = svgRelationships.selectAll('.relationship')\n      .data(relationships, function (d) { return d.id })\n\n    var relationshipEnter = appendRelationshipToGraph()\n\n    relationship = relationshipEnter.relationship.merge(relationship)\n\n    relationshipOutline = svg.selectAll('.relationship .outline')\n    relationshipOutline = relationshipEnter.outline.merge(relationshipOutline)\n\n    relationshipOverlay = svg.selectAll('.relationship .overlay')\n    relationshipOverlay = relationshipEnter.overlay.merge(relationshipOverlay)\n\n    relationshipText = svg.selectAll('.relationship .text')\n    relationshipText = relationshipEnter.text.merge(relationshipText)\n  }\n\n  function version () {\n    return VERSION\n  }\n\n  function zoomFit (transitionDuration) {\n    var bounds = svg.node().getBBox(),\n      parent = svg.node().parentElement.parentElement,\n      fullWidth = parent.clientWidth,\n      fullHeight = parent.clientHeight,\n      width = bounds.width,\n      height = bounds.height,\n      midX = bounds.x + width / 2,\n      midY = bounds.y + height / 2\n\n    if (width === 0 || height === 0) {\n      return // nothing to fit\n    }\n    svgScale = 0.85 / Math.max(width / fullWidth, height / fullHeight)\n    svgTranslate = [fullWidth / 2 - svgScale * midX, fullHeight / 2 - svgScale * midY]\n\n    svg.attr('transform', 'translate(' + svgTranslate[0] + ', ' + svgTranslate[1] + ') scale(' + svgScale + ')')\n    //        smoothTransform(svgTranslate, svgScale);\n  }\n\n  init(_selector, _options)\n  return {\n    appendRandomDataToNode: appendRandomDataToNode,\n    neo4jDataToD3Data: neo4jDataToD3Data,\n    randomD3Data: randomD3Data,\n    size: size,\n    updateWithD3Data: updateWithD3Data,\n    updateWithNeo4jData: updateWithNeo4jData,\n    version: version\n  }\n}\n\nexport default Neo4jD3\n"]},"metadata":{},"sourceType":"module"}